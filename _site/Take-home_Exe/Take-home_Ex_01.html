<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dew Stella Chan">
<meta name="dcterms.date" content="2025-02-01">

<title>Take-Home Exercise 01 – ISSS608 Coursework</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-bd8cb2610f6c2810c4bc87234a365cf8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS608 Coursework</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_00.html">
 <span class="dropdown-text">Hands-on Exercise 0</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_08qmd.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_08_newTmap.html">
 <span class="dropdown-text">Hands-on Exercise 8_tmap 4.0</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Exe/Hands-on_Ex_10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../In-class_Exe/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Exe/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Exe/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../Take-home_Exe/Take-home_Ex_01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Take-home_Exe/Take-home_Ex_02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Take-home_Exe/Take-home_Ex_03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://isss608jan25group7.netlify.app/"> 
<span class="menu-text">Group 7 Project</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#required-task" id="toc-required-task" class="nav-link active" data-scroll-target="#required-task">Required Task</a></li>
  <li><a href="#loading-of-packages" id="toc-loading-of-packages" class="nav-link" data-scroll-target="#loading-of-packages">1.0 Loading of Packages</a></li>
  <li><a href="#importing-of-data-and-data-preparation." id="toc-importing-of-data-and-data-preparation." class="nav-link" data-scroll-target="#importing-of-data-and-data-preparation.">2.0 Importing of Data and Data Preparation.</a>
  <ul class="collapse">
  <li><a href="#importing-data." id="toc-importing-data." class="nav-link" data-scroll-target="#importing-data.">2.1 Importing data.</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">2.2 Data Preparation</a></li>
  <li><a href="#check-for-missing-values" id="toc-check-for-missing-values" class="nav-link" data-scroll-target="#check-for-missing-values">2.3 Check for missing values</a></li>
  <li><a href="#transforming-the-data-to-the-4-main-sub-group." id="toc-transforming-the-data-to-the-4-main-sub-group." class="nav-link" data-scroll-target="#transforming-the-data-to-the-4-main-sub-group.">2.4 Transforming the data to the 4 main sub group.</a></li>
  <li><a href="#re-coding-catological-data-for-logistic-regression" id="toc-re-coding-catological-data-for-logistic-regression" class="nav-link" data-scroll-target="#re-coding-catological-data-for-logistic-regression">2.5 Re-coding Catological data for Logistic Regression</a></li>
  <li><a href="#prepare-of-varies-data-frame-for-easy-of-infographic." id="toc-prepare-of-varies-data-frame-for-easy-of-infographic." class="nav-link" data-scroll-target="#prepare-of-varies-data-frame-for-easy-of-infographic.">2.6 Prepare of varies data frame for easy of infographic.</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">3.0 Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
  <li><a href="#visualising-distribution-of-the-categorical-variables" id="toc-visualising-distribution-of-the-categorical-variables" class="nav-link" data-scroll-target="#visualising-distribution-of-the-categorical-variables">3.1 Visualising Distribution of the Categorical Variables</a></li>
  <li><a href="#visualising-distribution-of-the-continuous-variables" id="toc-visualising-distribution-of-the-continuous-variables" class="nav-link" data-scroll-target="#visualising-distribution-of-the-continuous-variables">3.2 Visualising Distribution of the Continuous Variables</a></li>
  </ul></li>
  <li><a href="#confirmatory-data-analysis-cda" id="toc-confirmatory-data-analysis-cda" class="nav-link" data-scroll-target="#confirmatory-data-analysis-cda">4.0 Confirmatory Data Analysis (CDA)</a>
  <ul class="collapse">
  <li><a href="#chi-square-test-for-youth-data" id="toc-chi-square-test-for-youth-data" class="nav-link" data-scroll-target="#chi-square-test-for-youth-data">4.1 Chi Square test for youth data</a></li>
  <li><a href="#significant-test-of-association-dependence-ggbarstats-methods" id="toc-significant-test-of-association-dependence-ggbarstats-methods" class="nav-link" data-scroll-target="#significant-test-of-association-dependence-ggbarstats-methods">4.2 Significant Test of Association (Dependence) : ggbarstats() methods</a></li>
  <li><a href="#chi-square-for-subjects-with-heart-attack-of-the-two-different-age-group" id="toc-chi-square-for-subjects-with-heart-attack-of-the-two-different-age-group" class="nav-link" data-scroll-target="#chi-square-for-subjects-with-heart-attack-of-the-two-different-age-group">4.3 Chi Square for subjects with heart attack of the two different age group</a></li>
  <li><a href="#anova-performed-on-the-youth-group." id="toc-anova-performed-on-the-youth-group." class="nav-link" data-scroll-target="#anova-performed-on-the-youth-group.">4.5 Anova performed on the youth group.</a></li>
  </ul></li>
  <li><a href="#model-building" id="toc-model-building" class="nav-link" data-scroll-target="#model-building">5.0 Model building</a>
  <ul class="collapse">
  <li><a href="#logistic-regression-model" id="toc-logistic-regression-model" class="nav-link" data-scroll-target="#logistic-regression-model">5.1 Logistic Regression Model</a></li>
  <li><a href="#variables-important" id="toc-variables-important" class="nav-link" data-scroll-target="#variables-important">5.2 Variables important</a></li>
  </ul></li>
  <li><a href="#final-charts-and-conclusion" id="toc-final-charts-and-conclusion" class="nav-link" data-scroll-target="#final-charts-and-conclusion">6.0 Final charts and conclusion</a>
  <ul class="collapse">
  <li><a href="#other-charts-and-visualisation-tools-used." id="toc-other-charts-and-visualisation-tools-used." class="nav-link" data-scroll-target="#other-charts-and-visualisation-tools-used.">7.0 Other Charts and visualisation tools used.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-Home Exercise 01</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dew Stella Chan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 1, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 30, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<p>This quota document shows the visual analytics conducted for the Take Home Exercise 01, The data set chosen is the <a href="https://www.kaggle.com/code/radhikaarajdev/heart-attack-risk-youth-vs-adults-in-japan">Heart Attack in Japan Youth Vs Adult</a> from Kaggle.</p>
<section id="required-task" class="level2">
<h2 class="anchored" data-anchor-id="required-task">Required Task</h2>
<p>The main task is to develop graphical visuals for a media company on an article for the possible factors leading to heart attack trends in Japanese Youth.</p>
<p>The plan is to carry out exploratory and confirmatory data analysis to confirm the observed trend before doing up the visuals required for the graphic.</p>
<p>The goal is to find out if there are any observable trends and health or lifestyle factors leading to the occurrence of heart attack in Japanese youth.</p>
<p>For the purpose of this analysis, I define Japanese youth as individuals under the age of 35, following the definition provided in the article on <a href="https://www.jil.go.jp/english/jli/documents/2023/041-05.pdf">Youth Employment Policies in Japan</a>. The data set is catogrised into 4 main groups as follows:</p>
<ol type="1">
<li>Youths who have experienced a heart attack (interest group),</li>
<li>Youths who have not experienced a heart attack,</li>
<li>Adults who have experienced a heart attack,</li>
<li>Adults who have not experienced a heart attack.</li>
</ol>
<p>Population with age above 65, they will be omitted from this study as age above 65 and above are considered as elderly based on the <a href="https://en.wikipedia.org/wiki/Aging_of_Japan#:~:text=Article,as%20South%20Korea%20and%20China.">Wikipedia.</a></p>
</section>
<section id="loading-of-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-of-packages">1.0 Loading of Packages</h2>
<p>The following code chunk indicates the list of packages used for this Take Home Exercise 01.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(haven, SmartEDA, tidyverse, tidymodels, ggdist, ggridges, ggthemes,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               colorspace, gridExtra, ggstatsplot, GGally, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               readxl, performance, parameters, car,aod, ggExtra, ggiraph, corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-of-data-and-data-preparation." class="level2">
<h2 class="anchored" data-anchor-id="importing-of-data-and-data-preparation.">2.0 Importing of Data and Data Preparation.</h2>
<section id="importing-data." class="level3">
<h3 class="anchored" data-anchor-id="importing-data.">2.1 Importing data.</h3>
<p>As the data is in csv file format, the data is loaded using read_csv function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>heart <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Ex01/japan_heart_attack_dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">2.2 Data Preparation</h3>
<p>As the metadata did not specify the data in the extra column 1 to 15, hence we will not be able the data in the “Extra_column 1 to 15”</p>
<p>The first step of data preparation is to remove them first, and remove population who are above 64.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>heart <span class="ot">&lt;-</span> heart <span class="sc">%&gt;%</span> <span class="fu">select</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (Age <span class="sc">&lt;</span> <span class="dv">65</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The summary and head functions are used to view and examine the data before proceeding further.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Age          Gender             Region          Smoking_History   
 Min.   :18.0   Length:22671       Length:22671       Length:22671      
 1st Qu.:29.0   Class :character   Class :character   Class :character  
 Median :41.0   Mode  :character   Mode  :character   Mode  :character  
 Mean   :40.9                                                           
 3rd Qu.:53.0                                                           
 Max.   :64.0                                                           
 Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity 
 Length:22671       Length:22671         Min.   : 80.02    Length:22671      
 Class :character   Class :character     1st Qu.:179.45    Class :character  
 Mode  :character   Mode  :character     Median :199.72    Mode  :character  
                                         Mean   :199.83                      
                                         3rd Qu.:220.10                      
                                         Max.   :311.24                      
 Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       
 Length:22671       Length:22671        Min.   : 0.000   Min.   : 5.58  
 Class :character   Class :character    1st Qu.: 3.637   1st Qu.:21.64  
 Mode  :character   Mode  :character    Median : 4.973   Median :24.97  
                                        Mean   : 4.988   Mean   :25.00  
                                        3rd Qu.: 6.337   3rd Qu.:28.39  
                                        Max.   :10.000   Max.   :44.12  
   Heart_Rate      Systolic_BP     Diastolic_BP    Family_History    
 Min.   : 30.59   Min.   : 63.1   Min.   : 39.95   Length:22671      
 1st Qu.: 63.23   1st Qu.:109.8   1st Qu.: 73.23   Class :character  
 Median : 69.92   Median :119.9   Median : 80.11   Mode  :character  
 Mean   : 69.93   Mean   :120.0   Mean   : 80.03                     
 3rd Qu.: 76.63   3rd Qu.:130.2   3rd Qu.: 86.78                     
 Max.   :108.78   Max.   :176.6   Max.   :117.66                     
 Heart_Attack_Occurrence
 Length:22671           
 Class :character       
 Mode  :character       
                        
                        
                        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (heart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 17
    Age Gender Region Smoking_History Diabetes_History Hypertension_History
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
1    56 Male   Urban  Yes             No               No                  
2    46 Male   Rural  Yes             No               No                  
3    32 Female Urban  No              No               No                  
4    60 Female Rural  No              No               No                  
5    25 Female Rural  No              No               No                  
6    38 Female Urban  Yes             No               No                  
# ℹ 11 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="check-for-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="check-for-missing-values">2.3 Check for missing values</h3>
<p>is.na function is used to check if the data contain any missing values,if there are, they are being added.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(heart))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Age                  Gender                  Region 
                      0                       0                       0 
        Smoking_History        Diabetes_History    Hypertension_History 
                      0                       0                       0 
      Cholesterol_Level       Physical_Activity            Diet_Quality 
                      0                       0                       0 
    Alcohol_Consumption           Stress_Levels                     BMI 
                      0                       0                       0 
             Heart_Rate             Systolic_BP            Diastolic_BP 
                      0                       0                       0 
         Family_History Heart_Attack_Occurrence 
                      0                       0 </code></pre>
</div>
</div>
<p>After removing the Extra columns, we continue by examining again the data using the summary and head functions to ensure that the extra columns are successfully removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Age          Gender             Region          Smoking_History   
 Min.   :18.0   Length:22671       Length:22671       Length:22671      
 1st Qu.:29.0   Class :character   Class :character   Class :character  
 Median :41.0   Mode  :character   Mode  :character   Mode  :character  
 Mean   :40.9                                                           
 3rd Qu.:53.0                                                           
 Max.   :64.0                                                           
 Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity 
 Length:22671       Length:22671         Min.   : 80.02    Length:22671      
 Class :character   Class :character     1st Qu.:179.45    Class :character  
 Mode  :character   Mode  :character     Median :199.72    Mode  :character  
                                         Mean   :199.83                      
                                         3rd Qu.:220.10                      
                                         Max.   :311.24                      
 Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       
 Length:22671       Length:22671        Min.   : 0.000   Min.   : 5.58  
 Class :character   Class :character    1st Qu.: 3.637   1st Qu.:21.64  
 Mode  :character   Mode  :character    Median : 4.973   Median :24.97  
                                        Mean   : 4.988   Mean   :25.00  
                                        3rd Qu.: 6.337   3rd Qu.:28.39  
                                        Max.   :10.000   Max.   :44.12  
   Heart_Rate      Systolic_BP     Diastolic_BP    Family_History    
 Min.   : 30.59   Min.   : 63.1   Min.   : 39.95   Length:22671      
 1st Qu.: 63.23   1st Qu.:109.8   1st Qu.: 73.23   Class :character  
 Median : 69.92   Median :119.9   Median : 80.11   Mode  :character  
 Mean   : 69.93   Mean   :120.0   Mean   : 80.03                     
 3rd Qu.: 76.63   3rd Qu.:130.2   3rd Qu.: 86.78                     
 Max.   :108.78   Max.   :176.6   Max.   :117.66                     
 Heart_Attack_Occurrence
 Length:22671           
 Class :character       
 Mode  :character       
                        
                        
                        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 17
    Age Gender Region Smoking_History Diabetes_History Hypertension_History
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;               
1    56 Male   Urban  Yes             No               No                  
2    46 Male   Rural  Yes             No               No                  
3    32 Female Urban  No              No               No                  
4    60 Female Rural  No              No               No                  
5    25 Female Rural  No              No               No                  
6    38 Female Urban  Yes             No               No                  
# ℹ 11 more variables: Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;,
#   Diet_Quality &lt;chr&gt;, Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;,
#   BMI &lt;dbl&gt;, Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>heart <span class="ot">&lt;-</span> heart <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Grp =</span> <span class="fu">ifelse</span>(Age <span class="sc">&gt;</span> <span class="dv">35</span>, <span class="st">"Adult"</span>, <span class="st">"Youth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transforming-the-data-to-the-4-main-sub-group." class="level3">
<h3 class="anchored" data-anchor-id="transforming-the-data-to-the-4-main-sub-group.">2.4 Transforming the data to the 4 main sub group.</h3>
<p>It was observed that the data consist two types of variables: namely continuous and categorical.</p>
<p>As mentioned in section 1.0, the data will be categorised into the 4 main group.</p>
<p>Given that the continuous data are consist of variables such as heart rate, cholesterol level, Systolic and Diastolic Blood Pressure, they are being categorized to established category . For this purpose of the analysis, we will use the range indicate in the following sites and with the help of Microsoft Co-pilot.</p>
<ol type="1">
<li><p><a href="https://www.cdc.gov/bmi/adult-calculator/bmi-categories.html?form=MG0AV3">Body Mass Index (BMI)</a></p></li>
<li><p><a href="https://www.heart.org/en/health-topics/high-blood-pressure?form=MG0AV3">Blood pressure (BP)</a></p></li>
<li><p><a href="https://www.heart.org/en/health-topics/cholesterol/about-cholesterol/what-your-cholesterol-levels-mean">Cholesterol Levels</a></p></li>
<li><p><a href="https://www.mayoclinic.org/healthy-lifestyle/fitness/expert-answers/heart-rate/faq-20057979">Heart Rate</a></p></li>
</ol>
<p>Using the following codes, the data are categorised into 4 main groups and the health indicators are categorized into the established data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>HA <span class="ot">&lt;-</span> heart <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Event_Grp =</span> <span class="fu">ifelse</span>(Age_Grp <span class="sc">==</span> <span class="st">"Adult"</span> <span class="sc">&amp;</span> Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"Adult_HA"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(Age_Grp <span class="sc">==</span> <span class="st">"Adult"</span> <span class="sc">&amp;</span> Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"Adult_No_HA"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(Age_Grp <span class="sc">==</span> <span class="st">"Youth"</span> <span class="sc">&amp;</span> Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"Youth_HA"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(Age_Grp <span class="sc">==</span> <span class="st">"Youth"</span> <span class="sc">&amp;</span> Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"Youth_No_HA"</span>,<span class="cn">NA</span>)))))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>HA <span class="ot">&lt;-</span> HA <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI_cat =</span> <span class="fu">case_when</span>( </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&lt;</span> <span class="fl">18.5</span> <span class="sc">~</span> <span class="st">"Underweight"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&gt;=</span> <span class="fl">18.5</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">25</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Overweight"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Obese"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>HA <span class="ot">&lt;-</span> HA <span class="sc">%&gt;%</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BP_cat =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    (Systolic_BP <span class="sc">&gt;=</span> <span class="dv">120</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">130</span>) <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    (Systolic_BP <span class="sc">&gt;=</span> <span class="dv">130</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">140</span>) <span class="sc">|</span> (Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">80</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">90</span>) <span class="sc">~</span> <span class="st">"High Stage 1"</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">|</span> Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">"High Stage 2"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>HA <span class="ot">&lt;-</span> HA <span class="sc">%&gt;%</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cholesterol_Level_cat =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    Cholesterol_Level <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"Desirable"</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    Cholesterol_Level <span class="sc">&gt;=</span> <span class="dv">200</span> <span class="sc">&amp;</span> Cholesterol_Level <span class="sc">&lt;</span> <span class="dv">240</span><span class="sc">~</span> <span class="st">"Borderline High"</span>,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    Cholesterol_Level <span class="sc">&gt;=</span> <span class="dv">240</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>HA <span class="ot">&lt;-</span> HA <span class="sc">%&gt;%</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Stress_Level_cat =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    Stress_Levels <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    Stress_Levels <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;</span> Stress_Levels <span class="sc">&lt;</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    Stress_Levels <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>HA <span class="ot">&lt;-</span> HA <span class="sc">%&gt;%</span> </span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Rate_cat =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    Heart_Rate <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Below Normal"</span>,</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    Heart_Rate <span class="sc">&gt;=</span>  <span class="dv">70</span> <span class="sc">&amp;</span> Heart_Rate <span class="sc">&lt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    Heart_Rate  <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Examine of missing data after recoding</p>
<p>note that there are 277 recids of BMI data and 108 of chelesterol records not being</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(HA))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Age                  Gender                  Region 
                      0                       0                       0 
        Smoking_History        Diabetes_History    Hypertension_History 
                      0                       0                       0 
      Cholesterol_Level       Physical_Activity            Diet_Quality 
                      0                       0                       0 
    Alcohol_Consumption           Stress_Levels                     BMI 
                      0                       0                       0 
             Heart_Rate             Systolic_BP            Diastolic_BP 
                      0                       0                       0 
         Family_History Heart_Attack_Occurrence                 Age_Grp 
                      0                       0                       0 
              Event_Grp                 BMI_cat                  BP_cat 
                      0                       0                       0 
  Cholesterol_Level_cat        Stress_Level_cat          Heart_Rate_cat 
                      0                       0                       0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(HA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Age          Gender             Region          Smoking_History   
 Min.   :18.0   Length:22671       Length:22671       Length:22671      
 1st Qu.:29.0   Class :character   Class :character   Class :character  
 Median :41.0   Mode  :character   Mode  :character   Mode  :character  
 Mean   :40.9                                                           
 3rd Qu.:53.0                                                           
 Max.   :64.0                                                           
 Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity 
 Length:22671       Length:22671         Min.   : 80.02    Length:22671      
 Class :character   Class :character     1st Qu.:179.45    Class :character  
 Mode  :character   Mode  :character     Median :199.72    Mode  :character  
                                         Mean   :199.83                      
                                         3rd Qu.:220.10                      
                                         Max.   :311.24                      
 Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       
 Length:22671       Length:22671        Min.   : 0.000   Min.   : 5.58  
 Class :character   Class :character    1st Qu.: 3.637   1st Qu.:21.64  
 Mode  :character   Mode  :character    Median : 4.973   Median :24.97  
                                        Mean   : 4.988   Mean   :25.00  
                                        3rd Qu.: 6.337   3rd Qu.:28.39  
                                        Max.   :10.000   Max.   :44.12  
   Heart_Rate      Systolic_BP     Diastolic_BP    Family_History    
 Min.   : 30.59   Min.   : 63.1   Min.   : 39.95   Length:22671      
 1st Qu.: 63.23   1st Qu.:109.8   1st Qu.: 73.23   Class :character  
 Median : 69.92   Median :119.9   Median : 80.11   Mode  :character  
 Mean   : 69.93   Mean   :120.0   Mean   : 80.03                     
 3rd Qu.: 76.63   3rd Qu.:130.2   3rd Qu.: 86.78                     
 Max.   :108.78   Max.   :176.6   Max.   :117.66                     
 Heart_Attack_Occurrence   Age_Grp           Event_Grp        
 Length:22671            Length:22671       Length:22671      
 Class :character        Class :character   Class :character  
 Mode  :character        Mode  :character   Mode  :character  
                                                              
                                                              
                                                              
   BMI_cat             BP_cat          Cholesterol_Level_cat Stress_Level_cat  
 Length:22671       Length:22671       Length:22671          Length:22671      
 Class :character   Class :character   Class :character      Class :character  
 Mode  :character   Mode  :character   Mode  :character      Mode  :character  
                                                                               
                                                                               
                                                                               
 Heart_Rate_cat    
 Length:22671      
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
</section>
<section id="re-coding-catological-data-for-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="re-coding-catological-data-for-logistic-regression">2.5 Re-coding Catological data for Logistic Regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>HA <span class="ot">&lt;-</span> HA <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>      Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>      Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gender_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      Gender <span class="sc">==</span> <span class="st">"Male"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      Gender <span class="sc">==</span> <span class="st">"Female"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      Region <span class="sc">==</span> <span class="st">"Urban"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>      Region <span class="sc">==</span> <span class="st">"Rural"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Smoking_History_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>      Smoking_History <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>      Smoking_History <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diabetes_History_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>      Diabetes_History <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>      Diabetes_History <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hypertension_History_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>      Hypertension_History <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>      Hypertension_History <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Family_History_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>      Family_History <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>      Family_History <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Physical_Activity_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>      Physical_Activity <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>      Physical_Activity <span class="sc">==</span> <span class="st">"Moderate"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>      Physical_Activity <span class="sc">==</span> <span class="st">"Low"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diet_Quality_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>      Diet_Quality <span class="sc">==</span> <span class="st">"Good"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>      Diet_Quality <span class="sc">==</span> <span class="st">"Average"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>      Diet_Quality <span class="sc">==</span> <span class="st">"Poor"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Alcohol_Consumption_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>      Alcohol_Consumption <span class="sc">==</span> <span class="st">"None"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>      Alcohol_Consumption <span class="sc">==</span> <span class="st">"Low"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>      Alcohol_Consumption <span class="sc">==</span> <span class="st">"Moderate"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>      Alcohol_Consumption <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stress_Level_cat_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>      Stress_Level_cat <span class="sc">==</span> <span class="st">"Low"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>      Stress_Level_cat <span class="sc">==</span> <span class="st">"Moderate"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>      Stress_Level_cat <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI_cat_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>      BMI_cat <span class="sc">==</span> <span class="st">"Underweight"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>      BMI_cat <span class="sc">==</span> <span class="st">"Normal"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>      BMI_cat <span class="sc">==</span> <span class="st">"Overweight"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>      BMI_cat <span class="sc">==</span> <span class="st">"Obese"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heart_Rate_cat_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>      Heart_Rate_cat  <span class="sc">==</span> <span class="st">"Below Normal"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>      Heart_Rate_cat  <span class="sc">==</span> <span class="st">"Normal"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>      Heart_Rate_cat  <span class="sc">==</span> <span class="st">"Elevated"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">BP_cat_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>      BP_cat  <span class="sc">==</span> <span class="st">"Normal"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>      BP_cat  <span class="sc">==</span> <span class="st">"Elevated"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>      BP_cat  <span class="sc">==</span> <span class="st">"High Stage 1"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>      BP_cat  <span class="sc">==</span> <span class="st">"High Stage 2"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>),</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cholesterol_Level_cat_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>      Cholesterol_Level_cat  <span class="sc">==</span> <span class="st">"Desirable"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>      Cholesterol_Level_cat <span class="sc">==</span> <span class="st">"Borderline High"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>      Cholesterol_Level_cat  <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Checking of data after re-coding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(HA))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Age                      Gender 
                          0                           0 
                     Region             Smoking_History 
                          0                           0 
           Diabetes_History        Hypertension_History 
                          0                           0 
          Cholesterol_Level           Physical_Activity 
                          0                           0 
               Diet_Quality         Alcohol_Consumption 
                          0                           0 
              Stress_Levels                         BMI 
                          0                           0 
                 Heart_Rate                 Systolic_BP 
                          0                           0 
               Diastolic_BP              Family_History 
                          0                           0 
    Heart_Attack_Occurrence                     Age_Grp 
                          0                           0 
                  Event_Grp                     BMI_cat 
                          0                           0 
                     BP_cat       Cholesterol_Level_cat 
                          0                           0 
           Stress_Level_cat              Heart_Rate_cat 
                          0                           0 
Heart_Attack_Occurrence_num                  Gender_num 
                          0                           0 
                 Region_num         Smoking_History_num 
                          0                           0 
       Diabetes_History_num    Hypertension_History_num 
                          0                           0 
         Family_History_num       Physical_Activity_num 
                          0                           0 
           Diet_Quality_num     Alcohol_Consumption_num 
                          0                           0 
       Stress_Level_cat_num                 BMI_cat_num 
                          0                           0 
         Heart_Rate_cat_num                  BP_cat_num 
                          0                           0 
  Cholesterol_Level_cat_num 
                          0 </code></pre>
</div>
</div>
</section>
<section id="prepare-of-varies-data-frame-for-easy-of-infographic." class="level3">
<h3 class="anchored" data-anchor-id="prepare-of-varies-data-frame-for-easy-of-infographic.">2.6 Prepare of varies data frame for easy of infographic.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>HA_Yes <span class="ot">&lt;-</span> <span class="fu">filter</span>(HA, Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>HA_adult <span class="ot">&lt;-</span> <span class="fu">filter</span>(HA, Age_Grp <span class="sc">==</span> <span class="st">"Adult"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>HA_youth <span class="ot">&lt;-</span> <span class="fu">filter</span>(HA, Age_Grp <span class="sc">==</span> <span class="st">"Youth"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>HA_youth_yes <span class="ot">&lt;-</span> <span class="fu">filter</span>(HA_youth, Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-eda">3.0 Exploratory Data Analysis (EDA)</h2>
<p>We start off by understanding the distribution of the variables and examine if there were any observable trends to be tested out using confirmatory analysis.</p>
<section id="visualising-distribution-of-the-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="visualising-distribution-of-the-categorical-variables">3.1 Visualising Distribution of the Categorical Variables</h3>
<p>The aim of this task is to examine if there are any trends in categorical data in the occurrence of heart attack in Japanese population.</p>
<p>The code below is extract our the categorical data and summaries into the occurrence of heart attack by Heart occurrence Age Groups and Event Groups.</p>
<p>The data are processed using the following codes to allow flexibility when exploring the data set.Hence HA is being used instead of the subgroups. Those data sets would be used in the subsequent visuslisation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="ot">&lt;-</span> HA <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span><span class="fu">is.character</span>(.x) <span class="sc">||</span> <span class="fu">is.factor</span>(.x)))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>count_occurrences <span class="ot">&lt;-</span> categorical_columns <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span> <span class="sc">-</span> <span class="fu">c</span>(Heart_Attack_Occurrence, Age_Grp, Event_Grp), <span class="at">names_to =</span> <span class="st">"Category"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category, Value, Age_Grp, Heart_Attack_Occurrence, Event_Grp) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Occurrences =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bar_plots <span class="ot">&lt;-</span> count_occurrences <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Occurrences, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span>  </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Category, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Categorical Variables of The Study Population."</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Unique Values"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#4682B4"</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>bar_plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>The above chart shows the data distribution for the categorical variables of the data set.</p>
<p>It includes the entire data set of the risk factors with whom had have heart attack verse whom had not have attack in Japan in all age group.</p>
<p>Before visualizing the data, one would expect <a href="https://www.mayoclinic.org/diseases-conditions/heart-attack/symptoms-causes/syc-20373106">risk factors</a> such as high cholesterol level, elevated heart rate and with smoking history, will likely result in more occurrence of heart attack in but solely by looking at the distribution of the data, this may not be true.</p>
<p>The main take away from the analysis is that it seems there is no <strong>sole risk factor</strong> which will lead to heart attack with the Japanese population sampled for this data set.</p>
</div>
<section id="closer-examination-on-the-distribution-categorical-variables-in-different-age-group-in-youth-vs-adult" class="level4">
<h4 class="anchored" data-anchor-id="closer-examination-on-the-distribution-categorical-variables-in-different-age-group-in-youth-vs-adult">3.1.1 Closer Examination on the Distribution Categorical Variables in different Age group in Youth vs Adult</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>count_occurrences_yes <span class="ot">&lt;-</span> <span class="fu">filter</span>(count_occurrences,  Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>bar_plots_yes <span class="ot">&lt;-</span> count_occurrences_yes <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Occurrences, <span class="at">fill =</span> Age_Grp)) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Category, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Categorical Variables of subjects with Heart Attack Across Age Groups"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Youth"</span> <span class="ot">=</span> <span class="st">"#FF1493"</span>, <span class="st">"Adult"</span> <span class="ot">=</span> <span class="st">"#FFA07A"</span>))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>bar_plots_yes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>Due to the study population, contains more subjects with heart attack, it is good to visualise the distribution across the age groups with heart attack. This may provide some interesting insights.</p>
<p>The charts above show the distribution of the categorical variables for study subjects who had heart attack across different age groups.</p>
<p>At a glance, the general distribution across categorical variables may seem to be similar across both age groups but at a closer examination. the following observations could be seen:</p>
<ul>
<li><p>BP_cat “high stage 1” in adults has higher occurrence in heart attack when compared to youth.</p></li>
<li><p>In youth, the occurrence of heart attack across gender while in adult a slightly in male verse female.</p></li>
<li><p>There seems to be have more occurrence in heart attack occurring in urban setting than rural setting.</p></li>
<li><p>It seem to have association between BMI and heart attack with more slight more occurrence in overweight subjects as compared to other BMI category.</p></li>
<li><p>It seems that there is association with moderate stress level with high proportion in both age groups.</p></li>
</ul>
<p>From the distribution, it seems that there is no sole factor which stand out in the youth population which will result in heart attack, confirmatory analysis would be need to confirm the analysis or explanatory model using logistic regression could be carried out to further explain risk factors.</p>
</div>
</section>
<section id="closer-examination-on-the-distribution-categorical-variables-in-the-youth-age-group." class="level4">
<h4 class="anchored" data-anchor-id="closer-examination-on-the-distribution-categorical-variables-in-the-youth-age-group.">3.1.2 Closer Examination on the Distribution Categorical Variables in the Youth Age group.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>count_occurrences_youth <span class="ot">&lt;-</span> <span class="fu">filter</span>(count_occurrences,  Age_Grp <span class="sc">==</span> <span class="st">"Youth"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>bar_plots_yes <span class="ot">&lt;-</span> count_occurrences_youth <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Occurrences, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Category, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Categorical Variables of subjects with Heart Attack in Youth"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#FF1493"</span>, <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#87CEEB"</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>bar_plots_yes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>Similar to the bar charts in section 3.1, there is no <em>sole risk factor</em> which stands out in the categorical variables which lead to high occurrence in the youth population.</p>
</div>
</section>
</section>
<section id="visualising-distribution-of-the-continuous-variables" class="level3">
<h3 class="anchored" data-anchor-id="visualising-distribution-of-the-continuous-variables">3.2 Visualising Distribution of the Continuous Variables</h3>
<p>The following codes is to prepared the data to plot histogram to visualise the continuous data.</p>
<p>The data is prepared this manner so that it will provide flexibility in showing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>contin_col_HA <span class="ot">&lt;-</span> heart <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric), Heart_Attack_Occurrence, Age_Grp)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>contin_col_HA_youth <span class="ot">&lt;-</span> <span class="fu">filter</span>(contin_col_HA, Age_Grp <span class="sc">==</span> <span class="st">"Youth"</span>)  </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>contin_col_HA_Yes <span class="ot">&lt;-</span> <span class="fu">filter</span>(contin_col_HA, Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>contin_col_HA_Long<span class="ot">&lt;-</span>contin_col_HA <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Heart_Attack_Occurrence, Age_Grp), <span class="at">names_to =</span> <span class="st">"Field"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>contin_col_HA_Long_Yes <span class="ot">&lt;-</span> <span class="fu">filter</span>(contin_col_HA_Long, Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>contin_col_HA_Long_youth <span class="ot">&lt;-</span> <span class="fu">filter</span>(contin_col_HA_Long, Age_Grp <span class="sc">==</span> <span class="st">"Youth"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>histograms_HA <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(contin_col_HA_Long, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Heart_Attack_Occurrence )) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograms of Continuous Variables"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Field, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#4682B4"</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>histograms_HA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>To visualise the continuous variables, the continuous variables were plotted using the Heart data without re-coding. This is to allow us to be able to view this distribution of the continuous variables.</p>
<p>Based on the histogram, the distribution of of the continuous variables for BMI, Cholesterol Level, Diastolic and Systolic blood pressure, stress levels and heart rate seems to be over normal distribution. The overall trend is similar between across the subjects regardless if they had or had not have a heart attack.</p>
</div>
<section id="closer-look-and-the-youth-age-group" class="level4">
<h4 class="anchored" data-anchor-id="closer-look-and-the-youth-age-group">3.2.1 Closer look and the Youth Age Group</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>histograms_HA_youth <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(contin_col_HA_Long_youth, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Heart_Attack_Occurrence )) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograms of Continuous Variables"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Field, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#FF1493"</span>, <span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#87CEEB"</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>histograms_HA_youth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>Comparing the occurrence of heart attack in youth, it follows the same distribution as the over all data. It was noted that similar to the overall data, there resembles the normality in the BMI, Cholesterol, Diastolic and systolic blood pressure, heart rate and stress levels.</p>
<p>This maybe logical as these variables are measure of bodily vitals or measurements, and due to homostasis the self regulating ability of the human body it will be normal to be peak in the center.</p>
<p>Hence to better understand variables, it may be more meaning for categorszed them into established bench marks such as what if the rest heart rate above 100 is considered as elevated.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 24 #to widen the space</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 24 #to lengthen the graph</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>HA_youth <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ExpNumViz</span>(<span class="at">target =</span> <span class="st">"Heart_Attack_Occurrence"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nlim=</span><span class="dv">10</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Page=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`0`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>Besides histogram, given that the distribution is resemble normal distribution, boxplot could be useful type of chart to visualise if there are any differences across the variables. It was noted that there maybe slight differences in stress levels between the youth with heart attack verse youth without heart attack.</p>
</div>
</section>
</section>
</section>
<section id="confirmatory-data-analysis-cda" class="level2">
<h2 class="anchored" data-anchor-id="confirmatory-data-analysis-cda">4.0 Confirmatory Data Analysis (CDA)</h2>
<section id="chi-square-test-for-youth-data" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-test-for-youth-data">4.1 Chi Square test for youth data</h3>
<p>Due to there is no trend observed by examining the barcharts, the chi square was ran using all variables.</p>
<p>After running the above associative test, the following code chunk to carry out the chi-square test to find our variables with association between heart attacks and categorical variables. The following codes on how to perform chi-square is generated using co-pilot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>analyze_association <span class="ot">&lt;-</span> <span class="cf">function</span>(data, x, y) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Chi-Square test</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  table <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[x]], data[[y]])</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(table)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print Chi-Square test results</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Chi-Square Test between"</span>, x, <span class="st">"and"</span>, y))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(chi_test)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze association for each categorical column with Heart_Attack_Occurrence</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (column <span class="cf">in</span> <span class="fu">colnames</span>(categorical_columns)) {</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>(column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Heart_Attack_Occurrence"</span>, <span class="st">"Event_Grp"</span>, <span class="st">"Age_Grp"</span>)))  </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">analyze_association</span>(HA_youth, column, <span class="st">"Heart_Attack_Occurrence"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-Square Test between Gender and Heart_Attack_Occurrence"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.058062, df = 1, p-value = 0.8096

[1] "Chi-Square Test between Region and Heart_Attack_Occurrence"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.25033, df = 1, p-value = 0.6168

[1] "Chi-Square Test between Smoking_History and Heart_Attack_Occurrence"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.16193, df = 1, p-value = 0.6874

[1] "Chi-Square Test between Diabetes_History and Heart_Attack_Occurrence"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 7.4232, df = 1, p-value = 0.006439

[1] "Chi-Square Test between Hypertension_History and Heart_Attack_Occurrence"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 1.0644, df = 1, p-value = 0.3022

[1] "Chi-Square Test between Physical_Activity and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 0.19892, df = 2, p-value = 0.9053

[1] "Chi-Square Test between Diet_Quality and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 3.2215, df = 2, p-value = 0.1997

[1] "Chi-Square Test between Alcohol_Consumption and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 3.487, df = 3, p-value = 0.3224

[1] "Chi-Square Test between Family_History and Heart_Attack_Occurrence"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.16224, df = 1, p-value = 0.6871

[1] "Chi-Square Test between BMI_cat and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 8.7346, df = 3, p-value = 0.03304

[1] "Chi-Square Test between BP_cat and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 3.0918, df = 3, p-value = 0.3777

[1] "Chi-Square Test between Cholesterol_Level_cat and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 3.9627, df = 2, p-value = 0.1379

[1] "Chi-Square Test between Stress_Level_cat and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 4.9121, df = 2, p-value = 0.08577</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-Square Test between Heart_Rate_cat and Heart_Attack_Occurrence"

    Pearson's Chi-squared test

data:  table
X-squared = 0.78781, df = 2, p-value = 0.6744</code></pre>
</div>
</div>
</section>
<section id="significant-test-of-association-dependence-ggbarstats-methods" class="level3">
<h3 class="anchored" data-anchor-id="significant-test-of-association-dependence-ggbarstats-methods">4.2 Significant Test of Association (Dependence) : ggbarstats() methods</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>A_HA_youth_BMI <span class="ot">&lt;-</span> <span class="fu">ggbarstats</span>(HA_youth, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">x=</span>BMI_cat,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>Heart_Attack_Occurrence)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>A_HA_youth_Dia <span class="ot">&lt;-</span> <span class="fu">ggbarstats</span>(HA_youth, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">x=</span>Diabetes_History,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>Heart_Attack_Occurrence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 120 #to widen the space</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 120 #to lengthen the graph</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>Patchwork_sig <span class="ot">&lt;-</span> (A_HA_youth_Dia <span class="sc">|</span> A_HA_youth_BMI)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>Patchwork_sig </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>Using the ggbarstats, we are able to view the associations between diabetes history and BMI verse heart attack occurrence in youth.</p>
<p>For <strong>Diabetes history</strong>, it is clear that youth with diabetes history have higher association or may have high risk with heart attack as compared to youth without diabetes in the past.</p>
<p>For the <strong>BMI category</strong>, while the statistical test seems that BMI category may be significant, however it seems like the proportion of youth with normal BMI may result in high proportion of youth has heart attack. While it is consistent with general knowledge, it is noted the youth who are underweight has slightly less association of having heart attack.</p>
<p>Further analysis using logistic regression would be required to further understand the relationship.</p>
</div>
</section>
<section id="chi-square-for-subjects-with-heart-attack-of-the-two-different-age-group" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-for-subjects-with-heart-attack-of-the-two-different-age-group">4.3 Chi Square for subjects with heart attack of the two different age group</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>analyze_association <span class="ot">&lt;-</span> <span class="cf">function</span>(data, x, y) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Chi-Square test</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  table <span class="ot">&lt;-</span> <span class="fu">table</span>(data[[x]], data[[y]])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(table)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print Chi-Square test results</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Chi-Square Test between"</span>, x, <span class="st">"and"</span>, y))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(chi_test)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze association for each categorical column with Heart_Attack_Occurrence</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (column <span class="cf">in</span> <span class="fu">colnames</span>(categorical_columns)) {</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>(column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Heart_Attack_Occurrence"</span>, <span class="st">"Event_Grp"</span>, <span class="st">"Age_Grp"</span>)))  </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">analyze_association</span>(HA_Yes, column, <span class="st">"Age_Grp"</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-Square Test between Gender and Age_Grp"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 1.4995, df = 1, p-value = 0.2207

[1] "Chi-Square Test between Region and Age_Grp"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.31905, df = 1, p-value = 0.5722

[1] "Chi-Square Test between Smoking_History and Age_Grp"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.53203, df = 1, p-value = 0.4658

[1] "Chi-Square Test between Diabetes_History and Age_Grp"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 4.7694, df = 1, p-value = 0.02897

[1] "Chi-Square Test between Hypertension_History and Age_Grp"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.012936, df = 1, p-value = 0.9094

[1] "Chi-Square Test between Physical_Activity and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 0.93543, df = 2, p-value = 0.6264

[1] "Chi-Square Test between Diet_Quality and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 1.4703, df = 2, p-value = 0.4794

[1] "Chi-Square Test between Alcohol_Consumption and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 2.6902, df = 3, p-value = 0.4419

[1] "Chi-Square Test between Family_History and Age_Grp"

    Pearson's Chi-squared test with Yates' continuity correction

data:  table
X-squared = 0.084369, df = 1, p-value = 0.7715

[1] "Chi-Square Test between BMI_cat and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 0.53648, df = 3, p-value = 0.9108

[1] "Chi-Square Test between BP_cat and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 5.6781, df = 3, p-value = 0.1284

[1] "Chi-Square Test between Cholesterol_Level_cat and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 1.1245, df = 2, p-value = 0.5699

[1] "Chi-Square Test between Stress_Level_cat and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 0.51442, df = 2, p-value = 0.7732</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-Square Test between Heart_Rate_cat and Age_Grp"

    Pearson's Chi-squared test

data:  table
X-squared = 0.81758, df = 2, p-value = 0.6645</code></pre>
</div>
</div>
<div class="Callout-note">
<p>Based on chi square test, there no statistically significant variables for the between the categorical variables and age group. Hence the earlier observations in section 3.1.1 are not valid.</p>
</div>
</section>
<section id="anova-performed-on-the-youth-group." class="level3">
<h3 class="anchored" data-anchor-id="anova-performed-on-the-youth-group.">4.5 Anova performed on the youth group.</h3>
<p>Anova is performed to test the differences in true mean across continous variables for the youth with heart attack and without heart attack. The following code is steamlined with the help of Microsoft co-pilot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>perform_anova <span class="ot">&lt;-</span> <span class="cf">function</span>(data, group_var, continuous_vars) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (var <span class="cf">in</span> continuous_vars) {</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Performing ANOVA for"</span>, var, <span class="st">"by"</span>, group_var))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    anova_result <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">aov</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~"</span>, group_var)), <span class="at">data =</span> data))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    results[[var]] <span class="ot">&lt;-</span> anova_result</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(anova_result)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># List of continuous variables</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BMI"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each continuous variable in the Youth group</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>anova_results <span class="ot">&lt;-</span> <span class="fu">perform_anova</span>(contin_col_HA_youth, <span class="st">"Heart_Attack_Occurrence"</span>, continuous_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Performing ANOVA for BMI by Heart_Attack_Occurrence"
                          Df Sum Sq Mean Sq F value Pr(&gt;F)
Heart_Attack_Occurrence    1     36   35.69   1.415  0.234
Residuals               8764 221033   25.22               
[1] "Performing ANOVA for Cholesterol_Level by Heart_Attack_Occurrence"
                          Df  Sum Sq Mean Sq F value Pr(&gt;F)
Heart_Attack_Occurrence    1     707   707.2   0.786  0.375
Residuals               8764 7883042   899.5               
[1] "Performing ANOVA for Stress_Levels by Heart_Attack_Occurrence"
                          Df Sum Sq Mean Sq F value Pr(&gt;F)   
Heart_Attack_Occurrence    1     27   26.77    6.71 0.0096 **
Residuals               8764  34970    3.99                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
[1] "Performing ANOVA for Heart_Rate by Heart_Attack_Occurrence"
                          Df Sum Sq Mean Sq F value Pr(&gt;F)
Heart_Attack_Occurrence    1      0    0.24   0.002  0.961
Residuals               8764 882302  100.67               
[1] "Performing ANOVA for Systolic_BP by Heart_Attack_Occurrence"
                          Df  Sum Sq Mean Sq F value Pr(&gt;F)
Heart_Attack_Occurrence    1     202   202.0   0.896  0.344
Residuals               8764 1977029   225.6               
[1] "Performing ANOVA for Diastolic_BP by Heart_Attack_Occurrence"
                          Df Sum Sq Mean Sq F value Pr(&gt;F)
Heart_Attack_Occurrence    1      3    2.54   0.025  0.874
Residuals               8764 886533  101.16               </code></pre>
</div>
</div>
<section id="oneway-anova-test-ggbetweenstats-method" class="level4">
<h4 class="anchored" data-anchor-id="oneway-anova-test-ggbetweenstats-method">4.5.1 Oneway ANOVA Test: ggbetweenstats() method</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>stress <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> HA_youth,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Heart_Attack_Occurrence, </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Stress_Levels,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean.ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pairwise.comparisons =</span> <span class="cn">TRUE</span>, </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pairwise.display =</span> <span class="st">"s"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.adjust.method =</span> <span class="st">"fdr"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>stress</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the anova results, there is statistically significant differences in the stress levels between youth with heart attack verse youth whom have not had heart attack.</p>
<p>However, it is noted that there small effect size (Hedges’ g = 0.09) suggests that although the difference is statistically significant, but the small effect may not may not be large enough to have meaningful implications in a real-world context.</p>
<p>As the stress level maybe derived from Likert kind of survey, it maybe meaningful to categorise it to the different levels and analyse using logistic regression model. This had been done in section 2.6</p>
</div>
</div>
</section>
</section>
</section>
<section id="model-building" class="level2">
<h2 class="anchored" data-anchor-id="model-building">5.0 Model building</h2>
<p>Due to the lack of observable trends from CDA and EDA, explanatory model is build to further analysis if there are other variables, besides Stress level, BMI categories and Diabetes history, a logistic model is built to further analyse the data set for trends.</p>
<section id="logistic-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model">5.1 Logistic Regression Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>model_log_youth <span class="ot">&lt;-</span> <span class="fu">glm</span>(Heart_Attack_Occurrence_num  <span class="sc">~</span> Gender_num <span class="sc">+</span> Region_num <span class="sc">+</span> Smoking_History_num <span class="sc">+</span> Diabetes_History_num <span class="sc">+</span> Physical_Activity_num <span class="sc">+</span> Diet_Quality_num <span class="sc">+</span> Alcohol_Consumption_num <span class="sc">+</span> Stress_Level_cat_num <span class="sc">+</span> BMI_cat_num <span class="sc">+</span> Heart_Rate_cat_num <span class="sc">+</span> BP_cat_num <span class="sc">+</span>Family_History_num <span class="sc">+</span> Cholesterol_Level_cat_num, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> HA_youth)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the summary</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_log_youth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Heart_Attack_Occurrence_num ~ Gender_num + Region_num + 
    Smoking_History_num + Diabetes_History_num + Physical_Activity_num + 
    Diet_Quality_num + Alcohol_Consumption_num + Stress_Level_cat_num + 
    BMI_cat_num + Heart_Rate_cat_num + BP_cat_num + Family_History_num + 
    Cholesterol_Level_cat_num, family = binomial(), data = HA_youth)

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.93838    0.17306 -11.201  &lt; 2e-16 ***
Gender_num                 0.02215    0.07293   0.304  0.76134    
Region_num                -0.04617    0.07862  -0.587  0.55700    
Smoking_History_num        0.03464    0.07954   0.436  0.66320    
Diabetes_History_num       0.23270    0.08552   2.721  0.00651 ** 
Physical_Activity_num     -0.01854    0.04703  -0.394  0.69335    
Diet_Quality_num          -0.08240    0.04909  -1.678  0.09327 .  
Alcohol_Consumption_num   -0.05436    0.04016  -1.354  0.17585    
Stress_Level_cat_num      -0.11934    0.05435  -2.196  0.02810 *  
BMI_cat_num               -0.04134    0.05512  -0.750  0.45321    
Heart_Rate_cat_num         0.05784    0.07258   0.797  0.42557    
BP_cat_num                 0.02014    0.03454   0.583  0.55997    
Family_History_num        -0.03353    0.08030  -0.418  0.67629    
Cholesterol_Level_cat_num -0.07304    0.05659  -1.291  0.19681    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5509.8  on 8765  degrees of freedom
Residual deviance: 5488.9  on 8752  degrees of freedom
AIC: 5516.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model_log_youth))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              (Intercept)                Gender_num                Region_num 
                0.1439365                 1.0223990                 0.9548764 
      Smoking_History_num      Diabetes_History_num     Physical_Activity_num 
                1.0352488                 1.2620005                 0.9816281 
         Diet_Quality_num   Alcohol_Consumption_num      Stress_Level_cat_num 
                0.9209048                 0.9470903                 0.8875062 
              BMI_cat_num        Heart_Rate_cat_num                BP_cat_num 
                0.9595019                 1.0595403                 1.0203396 
       Family_History_num Cholesterol_Level_cat_num 
                0.9670273                 0.9295625 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check collinearity</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>check_c <span class="ot">&lt;-</span> <span class="fu">check_collinearity</span>(model_log_youth)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the collinearity check results</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(check_c)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot collinearity diagnostics</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(check_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(model_log_youth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                2.5 %      97.5 %
(Intercept)               -2.27756591 -1.59920051
Gender_num                -0.12079445  0.16509808
Region_num                -0.20026248  0.10791582
Smoking_History_num       -0.12126241  0.19054601
Diabetes_History_num       0.06507627  0.40032007
Physical_Activity_num     -0.11071131  0.07362587
Diet_Quality_num          -0.17862059  0.01382343
Alcohol_Consumption_num   -0.13307122  0.02434948
Stress_Level_cat_num      -0.22586001 -0.01281956
BMI_cat_num               -0.14936657  0.06668465
Heart_Rate_cat_num        -0.08442686  0.20009715
BP_cat_num                -0.04757126  0.08784222
Family_History_num        -0.19091804  0.12386083
Cholesterol_Level_cat_num -0.18395596  0.03787357</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_log_youth, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predicted_classes), <span class="fu">as.factor</span>(HA_youth<span class="sc">$</span>Heart_Attack_Occurrence_num))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 7932  834
         1    0    0
                                          
               Accuracy : 0.9049          
                 95% CI : (0.8985, 0.9109)
    No Information Rate : 0.9049          
    P-Value [Acc &gt; NIR] : 0.5092          
                                          
                  Kappa : 0               
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 1.0000          
            Specificity : 0.0000          
         Pos Pred Value : 0.9049          
         Neg Pred Value :    NaN          
             Prevalence : 0.9049          
         Detection Rate : 0.9049          
   Detection Prevalence : 1.0000          
      Balanced Accuracy : 0.5000          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="variables-important" class="level3">
<h3 class="anchored" data-anchor-id="variables-important">5.2 Variables important</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients from the model</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>coef_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(model_log_youth)))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>coef_data<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coef_data)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(coef_data) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the coefficients</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(coef_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Feature, Estimate), <span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#FF1493"</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Feature Importance (Logistic Regression Coefficients)"</span>,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Feature"</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Coefficient Estimate"</span>) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>The model results show that stress level and diabetes history are statically significant in leading to higher risk of heart attack in youth.</p>
<p>Besides two two variables, it seems that Diet quality may also play a role in leading heart attack in Japanese youth, although the significant level at 0.1 which is more than the standard 0.05.</p>
</div>
<section id="other-codes-in-looking-into-model-parameters-should-not-be-include-in-the-assignment-counts" class="level4">
<h4 class="anchored" data-anchor-id="other-codes-in-looking-into-model-parameters-should-not-be-include-in-the-assignment-counts">5.2.1 other codes in looking into model parameters (should not be include in the assignment counts)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_log_youth, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predicted_classes), <span class="fu">as.factor</span>(HA_youth<span class="sc">$</span>Heart_Attack_Occurrence_num))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 7932  834
         1    0    0
                                          
               Accuracy : 0.9049          
                 95% CI : (0.8985, 0.9109)
    No Information Rate : 0.9049          
    P-Value [Acc &gt; NIR] : 0.5092          
                                          
                  Kappa : 0               
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 1.0000          
            Specificity : 0.0000          
         Pos Pred Value : 0.9049          
         Neg Pred Value :    NaN          
             Prevalence : 0.9049          
         Detection Rate : 0.9049          
   Detection Prevalence : 1.0000          
      Balanced Accuracy : 0.5000          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(HA_youth), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(HA_youth))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> HA_youth[train_indices, ]</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> HA_youth[<span class="sc">-</span>train_indices, ]</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model on the training data</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>model_train <span class="ot">&lt;-</span> <span class="fu">glm</span>(Heart_Attack_Occurrence_num <span class="sc">~</span> Gender_num <span class="sc">+</span> Region_num <span class="sc">+</span> Smoking_History_num <span class="sc">+</span> Diabetes_History_num <span class="sc">+</span> Physical_Activity_num <span class="sc">+</span> Diet_Quality_num <span class="sc">+</span> Alcohol_Consumption_num <span class="sc">+</span> Stress_Level_cat_num <span class="sc">+</span> BMI_cat_num <span class="sc">+</span> Heart_Rate_cat_num <span class="sc">+</span> BP_cat_num <span class="sc">+</span> Family_History_num <span class="sc">+</span> Cholesterol_Level_cat_num, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> train_data)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test data</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_train, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>test_predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(test_predictions <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model on the test data</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(test_predicted_classes), <span class="fu">as.factor</span>(test_data<span class="sc">$</span>Heart_Attack_Occurrence_num))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 2373  257
         1    0    0
                                          
               Accuracy : 0.9023          
                 95% CI : (0.8903, 0.9134)
    No Information Rate : 0.9023          
    P-Value [Acc &gt; NIR] : 0.5166          
                                          
                  Kappa : 0               
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 1.0000          
            Specificity : 0.0000          
         Pos Pred Value : 0.9023          
         Neg Pred Value :    NaN          
             Prevalence : 0.9023          
         Detection Rate : 0.9023          
   Detection Prevalence : 1.0000          
      Balanced Accuracy : 0.5000          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoefstats</span>(model_log_youth, </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">output =</span> <span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model_log_youth )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5516.885</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="final-charts-and-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="final-charts-and-conclusion">6.0 Final charts and conclusion</h2>
<div class="Call-note">
<p>With acknowledge of the how the variables related to the occurrence of heart attack, in this section, we will do up the charts to visually show the relationship between the variables and heart attack in youth.</p>
<p>Since the earlier charts has already compared the main group of of interest youth with heart attack, with adults with heart attack and youth without heart attack. This section is dedicated to show visualise the relationship of the variables within the group</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>HA_youth_yes, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span> BMI, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span> Stress_Levels, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span>Diabetes_History)) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">40</span>),</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">11</span>))</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>P2<span class="ot">&lt;-</span> <span class="fu">ggMarginal</span>(P1, <span class="at">type =</span> <span class="st">"boxplot"</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColour =</span> <span class="cn">TRUE</span>, </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupFill =</span> <span class="cn">TRUE</span>)<span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>P3 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>HA_youth_yes,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Diabetes_History , <span class="at">y =</span> Stress_Levels, <span class="at">color =</span> Diet_Quality )) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> BMI_cat)<span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>P4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(HA_youth_yes, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Diabetes_History, <span class="at">y =</span> Stress_Levels)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">justification =</span> <span class="fl">0.1</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">justification =</span> <span class="fl">1.1</span>, </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">binwidth =</span> .<span class="dv">5</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">dotsize =</span> <span class="fl">0.05</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coord_flip() +</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_economist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 39
 $ line                :List of 6
  ..$ colour       : chr "black"
  ..$ linewidth    : NULL
  ..$ linetype     : NULL
  ..$ lineend      : NULL
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ rect                :List of 5
  ..$ fill         : Named chr NA
  .. ..- attr(*, "names")= chr NA
  ..$ colour       : logi NA
  ..$ linewidth    : NULL
  ..$ linetype     : num 1
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ text                :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : chr "black"
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title          :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x        :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.y        :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : num 90
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text           :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x         :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 10points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.top     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 10points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.y         :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 10points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.ticks          :List of 6
  ..$ colour       : NULL
  ..$ linewidth    : NULL
  ..$ linetype     : NULL
  ..$ lineend      : NULL
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ axis.ticks.y        : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ axis.ticks.length   : 'simpleUnit' num -5points
  ..- attr(*, "unit")= int 8
 $ axis.line           :List of 6
  ..$ colour       : NULL
  ..$ linewidth    : 'rel' num 0.8
  ..$ linetype     : NULL
  ..$ lineend      : NULL
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ axis.line.y         : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.background   :List of 5
  ..$ fill         : NULL
  ..$ colour       : NULL
  ..$ linewidth    : NULL
  ..$ linetype     : num 0
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ legend.spacing      : 'simpleUnit' num 15points
  ..- attr(*, "unit")= int 8
 $ legend.key          :List of 5
  ..$ fill         : NULL
  ..$ colour       : NULL
  ..$ linewidth    : NULL
  ..$ linetype     : num 0
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ legend.key.size     : 'simpleUnit' num 1.2lines
  ..- attr(*, "unit")= int 3
 $ legend.key.height   : NULL
 $ legend.key.width    : NULL
 $ legend.text         :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1.25
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.title        :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.position     : chr "top"
 $ legend.direction    : NULL
 $ legend.justification: chr "center"
 $ panel.background    :List of 5
  ..$ fill         : NULL
  ..$ colour       : NULL
  ..$ linewidth    : NULL
  ..$ linetype     : num 0
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ panel.border        : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ panel.spacing       : 'simpleUnit' num 0.25lines
  ..- attr(*, "unit")= int 3
 $ panel.grid.major    :List of 6
  ..$ colour       : chr "white"
  ..$ linewidth    : 'rel' num 1.75
  ..$ linetype     : NULL
  ..$ lineend      : NULL
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ panel.grid.minor    : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ plot.background     :List of 5
  ..$ fill         : Named chr "#d5e4eb"
  .. ..- attr(*, "names")= chr "blue-gray"
  ..$ colour       : logi NA
  ..$ linewidth    : NULL
  ..$ linetype     : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ plot.title          :List of 11
  ..$ family       : NULL
  ..$ face         : chr "bold"
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1.5
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ plot.margin         : 'simpleUnit' num [1:4] 12points 10points 12points 10points
  ..- attr(*, "unit")= int 8
 $ strip.background    :List of 5
  ..$ fill         : Named chr NA
  .. ..- attr(*, "names")= chr NA
  ..$ colour       : logi NA
  ..$ linewidth    : NULL
  ..$ linetype     : num 0
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ strip.text          :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1.25
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ strip.text.x        :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ strip.text.y        :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : num -90
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ panel.grid.major.x  : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 - attr(*, "class")= chr [1:2] "theme" "gg"
 - attr(*, "complete")= logi TRUE
 - attr(*, "validate")= logi TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 24 #to widen the space</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 24 #to lengthen the graph</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>Patchwork <span class="ot">&lt;-</span> P4 <span class="sc">|</span>P3</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>Patchwork</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="Callout-note">
<p>After establishing the following:</p>
<p>-Stress Level and Diabetes History have statistically significant related to incidents of heart attack in youth using the logistic regression model. Although diet history may not have statistically significant, but is worthwhile to explore its relationship with other variables.</p>
<p>-there is statistically significant differences in true group mean in stress level between youth whom had heart attack and without heart attack.</p>
<p>-the various BMI categories seem to have statically significant associations in relation of heart attack, proven using chi square.</p>
<p>The 4 variables of the <strong><em>youth whom had heart attack</em></strong> plotted using the half eye chart, box plot across the BMI categories to further analyse the relationships among the mentioned variables.</p>
<p><strong>Observation</strong></p>
<p>As mentioned in section 5, that the logistic regression, that the stress level is by Likert scale as the data is discrete instead of continuous as shown in the dot stats chart. Based on the chart, we can see the youth with higher stress level had diabetes before as compared to those who has not have diabetes before.</p>
<p>This trend could be further showed by the box plot on the right. The boxplot is facet across the various BMI categories.</p>
<p>At a quick glance, we could see obese youth whom had heart attack, has highest stress level. This particular group of youth also had the poor diet quality and diabetes before.</p>
<p>It was also noted there are overall higher stress level in overweight and obese youths as compared to those with normal BMI or underweight.</p>
<p>Among the youths, it was also noted. that two groups with the highest stress level are the obese and overweight youths with poor diet quality.</p>
<p>Further analysis could be carried out to further explore characteristic of Japanese Youth whom had heart attack. It is important to note that more information on the data set would be require before further conclusion could be drawn</p>
<p><strong>Conclusion</strong></p>
<p>Learning points from this take home exercise is that data visualising is not direct. It requires student or analyst to have a throughout understanding of the data set before the analyst could make use of the tools to present the data in a accurate and simplify manner which allow viewers to be able to see the trend of the data set.</p>
</div>
<section id="other-charts-and-visualisation-tools-used." class="level3">
<h3 class="anchored" data-anchor-id="other-charts-and-visualisation-tools-used.">7.0 Other Charts and visualisation tools used.</h3>
<p>As part of the learning journey, there are may other charts tried to visualise the data. However due to the assignment limit, they are not added to the main part of the assessment.</p>
<section id="histogram-to-compare-subjects-with-heart-attack-in-youth-and-adults" class="level5">
<h5 class="anchored" data-anchor-id="histogram-to-compare-subjects-with-heart-attack-in-youth-and-adults">Histogram to compare subjects with heart attack in youth and adults</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>histograms <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(contin_col_HA_Long_Yes, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Age_Grp )) <span class="sc">+</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograms of Continuous Fields"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Field, <span class="at">scales =</span> <span class="st">"free"</span>) </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the histograms</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(histograms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualizing-using-density-plot-to-further-understand-stress-level" class="level5">
<h5 class="anchored" data-anchor-id="visualizing-using-density-plot-to-further-understand-stress-level">visualizing using density plot to further understand stress level</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding density plot</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HA_youth, <span class="fu">aes</span>(<span class="at">x =</span> Stress_Levels)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram and Density Plot of Stress Levels"</span>, <span class="at">x =</span> <span class="st">"Stress Levels"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correlation-plots" class="level5">
<h5 class="anchored" data-anchor-id="correlation-plots">Correlation plots</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>HA.cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(HA_youth_yes[, <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>)], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(HA.cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HA, <span class="fu">aes</span>(<span class="at">x =</span> Stress_Levels, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span>  <span class="co"># Map fill to Heart_Attack_Occurrence</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span>  <span class="co"># Adjust position for overlap</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="co"># Density plot with transparency</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram and Density Plot of Stress Levels"</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Stress Levels"</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span>  <span class="co"># Improve overall theme and font size</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">name =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span>  <span class="co"># Use a color palette for filling</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)  <span class="co"># Position the legend at the top</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>scatter_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(HA, <span class="fu">aes</span>(<span class="at">x =</span> Stress_Levels, <span class="at">y =</span> BMI, <span class="at">color =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span>  <span class="co"># Adjust point size and transparency</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of Stress Levels vs. BMI"</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Stress Levels"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"BMI"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span>  <span class="co"># Add title and labels</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span>  <span class="co"># Use a clean theme with larger base font size</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))  <span class="co"># Customize colors if needed</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the scatter plot</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatter_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HA, <span class="fu">aes</span>(<span class="at">x =</span> Smoking_History, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Smoking History vs Heart Attack Occurrence"</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Smoking History"</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"salmon"</span>), <span class="at">name =</span> <span class="st">"Heart Attack Occurrence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex_01_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="disclaimer" class="level4">
<h4 class="anchored" data-anchor-id="disclaimer">Disclaimer</h4>
<p>This take home exercise was done with reference to methods in Prof Kam’s e text book https://r4va.netlify.app/ , materials on R available online and the use of Microsoft co-pilot to troubleshoot syntax errors and streamline codes.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>