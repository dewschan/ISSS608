{
  "hash": "f75ec19276903e3d5aeae853db4d0875",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on Exercise 02\"\nauthor: \"Dew Stella Chan\"\ndate: \"2025-01-20\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n## Loading of the required libraries\n\nIn this hands-one exercise, 6 R packages are used. Beside tidyverse which were used in Hands-on Exercise 1 and dplyr which is used to transform the dataframe to create meaningful label. The following packages are introduced.\n\n-   ggrepel: an R package provides geoms for ggplot2 to repel overlapping text labels.\n\n-   ggthemes: an R package provides some extra themes, geoms, and scales for ‘ggplot2’.\n\n-   hrbrthemes: an R package provides typography-centric themes and theme components for ggplot2.\n\n-   patchwork: an R package for preparing composite figure created using ggplot2.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse, gridExtra, dplyr \n               ) \n```\n:::\n\n\n\n### Loading of exam data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv(\"data/Exam_data.csv\")\n```\n:::\n\n\n\n## Beyond ggplot2 Annotation: ggrepel\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label(aes(label = ID), \n             hjust = .5, \n             vjust = -.5) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n### Data preparation for label and data to be plotted.\n\nTo make the above chart more meaningful, the following codes is to prepare the label so that the target audience of the chart could easily view the student IDs and the gender who scored higher for English and Chinese.\n\nIn this scenario, we are interested in students who scored above 80 for both subjects.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- exam_data %>%\n  mutate(ID_label=gsub(\"Student\", \"s_\",ID),\n         Gender_label= recode(GENDER, \"Female\"=\"F\", \"Male\" =\"M\"),\n         Label=str_c(ID_label,Gender_label,sep=\"\"))\n\nfiltered_data <- exam_data %>%\n  filter(MATHS > 80, ENGLISH > 80)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = filtered_data, \n       aes(x = MATHS, \n           y = ENGLISH)) +\n  geom_point() +\n  geom_smooth(method = lm, \n              size = 1) +  \n  geom_label(aes(label = Label, fill = GENDER,), \n             hjust = 0.1, \n             vjust = -0.1) +\n  scale_fill_manual(values = c(\"Female\" = \"pink\", \"Male\" = \"lightblue\")) +\n  coord_cartesian(xlim = c(80, 100),\n                  ylim = c(80, 100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3 for students above 80 \")+\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n### Working with ggrepel\n\nPlotting of the best fit line with outliners being labelled.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label_repel(aes(label = ID), \n                   fontface = \"bold\") +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## Beyond ggplot2 Themes\n\nggplot2 comes with eight built-in themes, they are: theme_gray(), theme_bw(), theme_classic(), theme_dark(), theme_light(), theme_linedraw(), theme_minimal(), and theme_void().\n\n### theme_gray()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  theme_gray() +\n  ggtitle(\"Distribution of Maths scores\") \n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n### Working with ggtheme package: theme_economist()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_economist()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n### Working with hrbthems package\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_ipsum()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_ipsum(axis_title_size = 18,\n              base_size = 15,\n              grid = \"Y\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## Beyond Single Graph\n\nWhen crafting the data story, it is common to represent the different dimensions of the data using multiple graphs and displaying them on the same page/slide to better illustrate and support the trends and observations.\n\nThis can be done using using function such as grid.arrange of the gridEXtra package (as used in [Hands-on Exercise 1](https://isss608-dewstella.netlify.app/hands-on_exe/hands-on_ex_01)) and plot_grid() of cowplot package.\n\nIn this section, we will be using ggplot2 extension called pactchwork which is designed for combining seperate ggplot charts into one single image.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of Maths scores\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot(data=exam_data, \n             aes(x = ENGLISH)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of English scores\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(data=exam_data, \n             aes(x= MATHS, \n                 y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n\n\n### Use of grid.arrange in gridExtra package\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrid.arrange(p1,p2, p3, ncol=3)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n### Creating Composite Graphics: pathwork methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + p2\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n### Combining three ggplot2 graphs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 / p2) | p3\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n### Creating figure with insert\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 + inset_element(p2, \n                   left = 0.02, \n                   bottom = 0.7, \n                   right = 0.5, \n                   top = 1)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\nThe inset element can be modified to be at the bottom too by adjusting the numbers in the function. But it is important to take note that the insert chart should not cover any points of the graph.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 + inset_element(p2, \n                   left = 0.02, \n                   bottom = 0.01, \n                   right = 0.5, \n                   top = 0.3)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n### Creating a composite figure by using patchwork and ggtheme\n\nFigure below is created by combining patchwork and theme_economist() of ggthemes package discussed earlier.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npatchwork <- (p1 / p2) | p3\npatchwork & theme_economist()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex_02_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Hands-on_Ex_02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}