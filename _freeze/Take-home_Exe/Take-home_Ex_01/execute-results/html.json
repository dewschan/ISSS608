{
  "hash": "5982b4abc62ea996866e72ea45b7ecb3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Exercise 01\"\nauthor: \"Dew Stella Chan\"\ndate: \"2025-02-01\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n# Take Home Exercise 01\n\nThis quota document shows the visual analytics conducted for the Take Home Exercise 01, The data set chosen is the [Heart Attack in Japan Youth Vs Adult](https://www.kaggle.com/code/radhikaarajdev/heart-attack-risk-youth-vs-adults-in-japan) from Kaggle.\n\n## Tasks Required\n\nThe main task is to develop graphical visuals for a media company on an article for the possible factor leading to heart attack trend in Japanese Youth.\n\nThe plan is to carry out exploratory and confirmatory data analysis to confirm the observed trend before doing up the visuals required for the graphic.\n\nSince the goal is to find out if there are any observable trends and health or lifestyle factors leading to the occurance of heart attack in japanese youth, we will be completing filtering the data into 3 main groups for exploretary analysis.\n\nFor this analysis we will be definiing Japanese youth as less 35 of age and the rest of the population considered as adults.\n\n1)  group of interest: Youth (15 to 34 https://www.jil.go.jp/english/jli/documents/2023/041-05.pdf (TBC))\n2)  youth with no heart attack 3)Adult with heart attack\n3)  adult with heart attack.\n\nGiven elderly are considered to be above 65, they will be omitted from this study\n\n## Loading of Packages\n\nThe following code chunk indicate the list of packages used for this Take Home Exercise 01\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(haven, SmartEDA, tidyverse, tidymodels, ggdist, ggridges, ggthemes,\n               colorspace, gridExtra, ggstatsplot, GGally, \n               readxl, performance, parameters, see)\n```\n:::\n\n\n\n## Loading of Data\n\nAs the data is in csv format, the data is loaded using read_csv function.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheart <- read_csv(\"data/Ex01/japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\n### Data Preparation\n\nsummary and head functions are used to view and examin the data type before further processing is carried out.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(heart)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age           Gender             Region          Smoking_History   \n Min.   :18.00   Length:30000       Length:30000       Length:30000      \n 1st Qu.:33.00   Class :character   Class :character   Class :character  \n Median :48.00   Mode  :character   Mode  :character   Mode  :character  \n Mean   :48.49                                                           \n 3rd Qu.:64.00                                                           \n Max.   :79.00                                                           \n Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity \n Length:30000       Length:30000         Min.   : 80.02    Length:30000      \n Class :character   Class :character     1st Qu.:179.55    Class :character  \n Mode  :character   Mode  :character     Median :199.77    Mode  :character  \n                                         Mean   :199.90                      \n                                         3rd Qu.:220.16                      \n                                         Max.   :336.86                      \n Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       \n Length:30000       Length:30000        Min.   : 0.000   Min.   : 5.58  \n Class :character   Class :character    1st Qu.: 3.644   1st Qu.:21.63  \n Mode  :character   Mode  :character    Median : 4.993   Median :24.96  \n                                        Mean   : 5.002   Mean   :25.00  \n                                        3rd Qu.: 6.353   3rd Qu.:28.36  \n                                        Max.   :10.000   Max.   :46.10  \n   Heart_Rate      Systolic_BP      Diastolic_BP    Family_History    \n Min.   : 30.03   Min.   : 56.23   Min.   : 39.95   Length:30000      \n 1st Qu.: 63.25   1st Qu.:109.79   1st Qu.: 73.26   Class :character  \n Median : 69.95   Median :119.90   Median : 80.12   Mode  :character  \n Mean   : 69.98   Mean   :119.91   Mean   : 80.03                     \n 3rd Qu.: 76.66   3rd Qu.:130.02   3rd Qu.: 86.76                     \n Max.   :108.78   Max.   :178.77   Max.   :117.67                     \n Heart_Attack_Occurrence Extra_Column_1     Extra_Column_2     \n Length:30000            Min.   :0.000007   Min.   :0.0000052  \n Class :character        1st Qu.:0.253308   1st Qu.:0.2473606  \n Mode  :character        Median :0.500820   Median :0.4961980  \n                         Mean   :0.501939   Mean   :0.4978940  \n                         3rd Qu.:0.750529   3rd Qu.:0.7473954  \n                         Max.   :0.999965   Max.   :0.9999894  \n Extra_Column_3      Extra_Column_4      Extra_Column_5     Extra_Column_6     \n Min.   :0.0000227   Min.   :0.0000934   Min.   :0.000105   Min.   :0.0000531  \n 1st Qu.:0.2483093   1st Qu.:0.2522110   1st Qu.:0.251803   1st Qu.:0.2559989  \n Median :0.4976104   Median :0.4976175   Median :0.501987   Median :0.5017726  \n Mean   :0.4981949   Mean   :0.5005952   Mean   :0.501410   Mean   :0.5027631  \n 3rd Qu.:0.7476807   3rd Qu.:0.7505662   3rd Qu.:0.753657   3rd Qu.:0.7511886  \n Max.   :0.9999694   Max.   :0.9999869   Max.   :0.999995   Max.   :0.9998892  \n Extra_Column_7      Extra_Column_8      Extra_Column_9     \n Min.   :0.0000678   Min.   :0.0000449   Min.   :0.0000305  \n 1st Qu.:0.2482839   1st Qu.:0.2509790   1st Qu.:0.2502452  \n Median :0.4988157   Median :0.4985698   Median :0.4984491  \n Mean   :0.4980753   Mean   :0.5003557   Mean   :0.5002292  \n 3rd Qu.:0.7456378   3rd Qu.:0.7507293   3rd Qu.:0.7512186  \n Max.   :0.9999900   Max.   :0.9999300   Max.   :0.9999852  \n Extra_Column_10     Extra_Column_11     Extra_Column_12    \n Min.   :0.0000133   Min.   :0.0000008   Min.   :0.0000713  \n 1st Qu.:0.2484256   1st Qu.:0.2538092   1st Qu.:0.2505341  \n Median :0.5031040   Median :0.5067589   Median :0.5038609  \n Mean   :0.5010694   Mean   :0.5044949   Mean   :0.5008624  \n 3rd Qu.:0.7522686   3rd Qu.:0.7556257   3rd Qu.:0.7511780  \n Max.   :0.9999928   Max.   :0.9999578   Max.   :0.9999484  \n Extra_Column_13     Extra_Column_14     Extra_Column_15    \n Min.   :0.0000204   Min.   :0.0000025   Min.   :0.0000241  \n 1st Qu.:0.2473108   1st Qu.:0.2482152   1st Qu.:0.2482573  \n Median :0.5041162   Median :0.4943841   Median :0.5009406  \n Mean   :0.5004557   Mean   :0.4976507   Mean   :0.4999634  \n 3rd Qu.:0.7497094   3rd Qu.:0.7456212   3rd Qu.:0.7487379  \n Max.   :0.9999451   Max.   :0.9999779   Max.   :0.9999913  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead (heart)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 32\n    Age Gender Region Smoking_History Diabetes_History Hypertension_History\n  <dbl> <chr>  <chr>  <chr>           <chr>            <chr>               \n1    56 Male   Urban  Yes             No               No                  \n2    69 Male   Urban  No              No               No                  \n3    46 Male   Rural  Yes             No               No                  \n4    32 Female Urban  No              No               No                  \n5    60 Female Rural  No              No               No                  \n6    25 Female Rural  No              No               No                  \n# ℹ 26 more variables: Cholesterol_Level <dbl>, Physical_Activity <chr>,\n#   Diet_Quality <chr>, Alcohol_Consumption <chr>, Stress_Levels <dbl>,\n#   BMI <dbl>, Heart_Rate <dbl>, Systolic_BP <dbl>, Diastolic_BP <dbl>,\n#   Family_History <chr>, Heart_Attack_Occurrence <chr>, Extra_Column_1 <dbl>,\n#   Extra_Column_2 <dbl>, Extra_Column_3 <dbl>, Extra_Column_4 <dbl>,\n#   Extra_Column_5 <dbl>, Extra_Column_6 <dbl>, Extra_Column_7 <dbl>,\n#   Extra_Column_8 <dbl>, Extra_Column_9 <dbl>, Extra_Column_10 <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n### Check for missing values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(heart))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Age                  Gender                  Region \n                      0                       0                       0 \n        Smoking_History        Diabetes_History    Hypertension_History \n                      0                       0                       0 \n      Cholesterol_Level       Physical_Activity            Diet_Quality \n                      0                       0                       0 \n    Alcohol_Consumption           Stress_Levels                     BMI \n                      0                       0                       0 \n             Heart_Rate             Systolic_BP            Diastolic_BP \n                      0                       0                       0 \n         Family_History Heart_Attack_Occurrence          Extra_Column_1 \n                      0                       0                       0 \n         Extra_Column_2          Extra_Column_3          Extra_Column_4 \n                      0                       0                       0 \n         Extra_Column_5          Extra_Column_6          Extra_Column_7 \n                      0                       0                       0 \n         Extra_Column_8          Extra_Column_9         Extra_Column_10 \n                      0                       0                       0 \n        Extra_Column_11         Extra_Column_12         Extra_Column_13 \n                      0                       0                       0 \n        Extra_Column_14         Extra_Column_15 \n                      0                       0 \n```\n\n\n:::\n:::\n\n\n\nAs the metadata did not specify the data is of the extra columns hence we will not be able the data in the \"Extra_column 1 to 15\"\n\nThe first step of data preparation is to remove them first.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHA <- heart %>% select (1:17) %>% filter (Age < 64)\n```\n:::\n\n\n\nAfter removing the Extra columns, we continue by examining the data using the summary and head (HA) function.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(HA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age           Gender             Region          Smoking_History   \n Min.   :18.00   Length:22158       Length:22158       Length:22158      \n 1st Qu.:29.00   Class :character   Class :character   Class :character  \n Median :40.00   Mode  :character   Mode  :character   Mode  :character  \n Mean   :40.37                                                           \n 3rd Qu.:52.00                                                           \n Max.   :63.00                                                           \n Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity \n Length:22158       Length:22158         Min.   : 80.02    Length:22158      \n Class :character   Class :character     1st Qu.:179.50    Class :character  \n Mode  :character   Mode  :character     Median :199.78    Mode  :character  \n                                         Mean   :199.90                      \n                                         3rd Qu.:220.15                      \n                                         Max.   :311.24                      \n Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       \n Length:22158       Length:22158        Min.   : 0.000   Min.   : 5.58  \n Class :character   Class :character    1st Qu.: 3.636   1st Qu.:21.63  \n Mode  :character   Mode  :character    Median : 4.973   Median :24.96  \n                                        Mean   : 4.987   Mean   :25.00  \n                                        3rd Qu.: 6.336   3rd Qu.:28.39  \n                                        Max.   :10.000   Max.   :44.12  \n   Heart_Rate      Systolic_BP     Diastolic_BP    Family_History    \n Min.   : 30.59   Min.   : 63.1   Min.   : 39.95   Length:22158      \n 1st Qu.: 63.22   1st Qu.:109.8   1st Qu.: 73.24   Class :character  \n Median : 69.92   Median :119.9   Median : 80.10   Mode  :character  \n Mean   : 69.94   Mean   :120.0   Mean   : 80.03                     \n 3rd Qu.: 76.64   3rd Qu.:130.2   3rd Qu.: 86.76                     \n Max.   :108.78   Max.   :176.6   Max.   :117.66                     \n Heart_Attack_Occurrence\n Length:22158           \n Class :character       \n Mode  :character       \n                        \n                        \n                        \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(HA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 17\n    Age Gender Region Smoking_History Diabetes_History Hypertension_History\n  <dbl> <chr>  <chr>  <chr>           <chr>            <chr>               \n1    56 Male   Urban  Yes             No               No                  \n2    46 Male   Rural  Yes             No               No                  \n3    32 Female Urban  No              No               No                  \n4    60 Female Rural  No              No               No                  \n5    25 Female Rural  No              No               No                  \n6    38 Female Urban  Yes             No               No                  \n# ℹ 11 more variables: Cholesterol_Level <dbl>, Physical_Activity <chr>,\n#   Diet_Quality <chr>, Alcohol_Consumption <chr>, Stress_Levels <dbl>,\n#   BMI <dbl>, Heart_Rate <dbl>, Systolic_BP <dbl>, Diastolic_BP <dbl>,\n#   Family_History <chr>, Heart_Attack_Occurrence <chr>\n```\n\n\n:::\n:::\n\n\n\n#### Trasnforming the data to the 4 main sub group.\n\nIt was observed that the data consist two main types: namely continous and categorical. The following steps we will examine the distibution of the each type of data in details.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHA <- HA %>%\n  mutate(Age_Grp = ifelse(Age > 35, \"Adult\", \"Youth\")) %>%\n  mutate(Event_Grp = ifelse(Age_Grp == \"Adult\" & Heart_Attack_Occurrence == \"Yes\", \"Adult_HA\",\n                    ifelse(Age_Grp == \"Adult\" & Heart_Attack_Occurrence == \"No\", \"Adult_No_HA\",\n                    ifelse(Age_Grp == \"Youth\" & Heart_Attack_Occurrence == \"Yes\", \"Youth_HA\",\n                    ifelse(Age_Grp == \"Youth\" & Heart_Attack_Occurrence == \"No\", \"Youth_No_HA\",NA)))))\n\nHA <- HA %>%\n  mutate(BMI_cat = case_when( \n    BMI < 18.5 ~ \"Underweight\",\n    BMI >= 18.5 & BMI < 24.9 ~ \"Normal\",\n    BMI >= 25 & BMI < 29.9 ~ \"Overweight\",\n    BMI >= 30 ~ \"Obese\",\n    TRUE ~ NA_character_\n  ))\n\nHA <- HA %>%\n  mutate(BP_cat = case_when(\n    Systolic_BP < 120 & Diastolic_BP < 80 ~ \"Normal\",\n    (Systolic_BP >= 120 & Systolic_BP < 130) & Diastolic_BP < 80 ~ \"Elevated\",\n    (Systolic_BP >= 130 & Systolic_BP < 140) | (Diastolic_BP >= 80 & Diastolic_BP < 90) ~ \"High Stage 1\",\n    Systolic_BP >= 140 | Diastolic_BP >= 90 ~ \"High Stage 2\",\n    TRUE ~ NA_character_\n  ))\nHA <- HA %>%\n  mutate(Cholesterol_Level_cat = case_when(\n    Cholesterol_Level < 200 ~ \"Desirable\",\n    Cholesterol_Level >= 200 & Cholesterol_Level < 239 ~ \"Borderline High\",\n    Cholesterol_Level >= 240 ~ \"High\",\n    TRUE ~ NA_character_\n  ))\n\nHA <- HA %>%\n  mutate(Stress_Level_cat = case_when(\n    Stress_Levels < 3 ~ \"Low\",\n    Stress_Levels >= 3 & Stress_Levels < 6 ~ \"Moderate\",\n    Stress_Levels >= 6 ~ \"High\",\n    TRUE ~ NA_character_\n  ))\n\n\nHA <- HA %>%\n  mutate(Heart_Attack_Occurrence_num = ifelse(Heart_Attack_Occurrence == \"Yes\", 1,\n                                              ifelse(Heart_Attack_Occurrence == \"No\", 0, NA)))\n\nHA <- HA %>% \n  mutate(Heart_Rate_cat = case_when(\n    Heart_Rate < 70 ~ \"Below Normal\",\n    Heart_Rate >=  70 & Heart_Rate <= 100 ~ \"Normal\",\n    Heart_Rate  > 100 ~ \"Elevated\",\n    TRUE ~ NA_character_\n  ))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Removal of NA data \n\nHA <- HA %>%\n  filter(!is.na(BMI_cat) & !is.na(Cholesterol_Level_cat))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nHA_Yes <- filter(HA, Heart_Attack_Occurrence == \"Yes\")\nHA_No <- filter(HA, Heart_Attack_Occurrence == \"No\")\nHA_youth <- filter(HA, Age_Grp == \"Youth\")\n```\n:::\n\n\n\n### Visualising of categorical Data\n\nThe aim of this task is to examine if there are any trends in categorical data in the occurance of heart attack in Japnaese population.\n\nThe code below is extract our the categorical data and summarise into the occurance of heart attack\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncategorical_columns <- HA %>% select(where(~is.character(.x) || is.factor(.x)))\n\ncount_occurrences <- categorical_columns %>%\n  pivot_longer(cols= - c(Heart_Attack_Occurrence, Age_Grp, Event_Grp), names_to = \"Category\", values_to = \"Value\") %>%\n  group_by(Category, Value, Age_Grp, Heart_Attack_Occurrence, Event_Grp) %>%\n  summarise(Occurrences = n(), .groups = 'drop')\n\nprint(count_occurrences)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 156 × 6\n   Category           Value Age_Grp Heart_Attack_Occurre…¹ Event_Grp Occurrences\n   <chr>              <chr> <chr>   <chr>                  <chr>           <int>\n 1 Alcohol_Consumpti… High  Adult   No                     Adult_No…        2308\n 2 Alcohol_Consumpti… High  Adult   Yes                    Adult_HA          277\n 3 Alcohol_Consumpti… High  Youth   No                     Youth_No…        1525\n 4 Alcohol_Consumpti… High  Youth   Yes                    Youth_HA          157\n 5 Alcohol_Consumpti… Low   Adult   No                     Adult_No…        3572\n 6 Alcohol_Consumpti… Low   Adult   Yes                    Adult_HA          402\n 7 Alcohol_Consumpti… Low   Youth   No                     Youth_No…        2372\n 8 Alcohol_Consumpti… Low   Youth   Yes                    Youth_HA          262\n 9 Alcohol_Consumpti… Mode… Adult   No                     Adult_No…        4804\n10 Alcohol_Consumpti… Mode… Adult   Yes                    Adult_HA          526\n# ℹ 146 more rows\n# ℹ abbreviated name: ¹​Heart_Attack_Occurrence\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create bar plots for each categorical field\nbar_plots <- count_occurrences %>%\n  ggplot(aes(x = Value, y = Occurrences, fill = Event_Grp)) + \n  geom_bar(stat = \"identity\", position = position_dodge()) +  # Use position_dodge for side-by-side bars\n  facet_wrap(~ Category, scales = \"free\") +\n  theme_minimal() +\n  labs(title = \"Counts of Unique Values in Categorical Fields\",\n       x = \"Unique Values\",\n       y = \"Count\") \n\n# Print the bar plots\nprint(bar_plots)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-13-1.png){width=1920}\n:::\n:::\n\n\n\n#### closer examination of categorical trend for those with heart attack\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncount_occurrences_youth <- filter(count_occurrences, Age_Grp == \"Youth\")\n\n# Create bar plots for each categorical field\nbar_plots <- count_occurrences_youth %>%\n  ggplot(aes(x = Value, y = Occurrences, fill = Heart_Attack_Occurrence)) + \n  geom_bar(stat = \"identity\", position = position_dodge()) +  # Use position_dodge for side-by-side bars\n  facet_wrap(~ Category, scales = \"free\") +\n  theme_minimal() +\n  labs(title = \"Counts of Unique Values in Categorical Fields\",\n       x = \"Unique Values\",\n       y = \"Count\") \n\n# Print the bar plots\nprint(bar_plots)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-14-1.png){width=1920}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#pm <- ggpairs(HA, columns = 1:17, ggplot2::aes(colour = Heart_Attack_Occurrence ))\n#print (pm)\n```\n:::\n\n\n\n## visualising continuous data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select only the continuous columns (numeric)\ncontin_col_HA <- HA %>% select(where(is.numeric), Heart_Attack_Occurrence, Age_Grp)\n\n\ncontin_col_HA_Long<-contin_col_HA %>%\n  pivot_longer(cols = -c(Heart_Attack_Occurrence, Age_Grp), names_to = \"Field\", values_to = \"Value\")\n               \ncontin_col_HA_Long_Yes <- filter(contin_col_HA_Long, Heart_Attack_Occurrence == \"Yes\")              \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create histograms with density plots for continuous variables\nhistograms <- ggplot(contin_col_HA_Long, aes(x = Value, fill = Heart_Attack_Occurrence )) + \n  geom_histogram(binwidth = 1, alpha = 0.8) + \n  theme_minimal() + \n  labs(title = \"Histograms of Continuous Fields\", x = \"Value\", y = \"Frequency\")+\n  facet_wrap(~ Field, scales = \"free\") \n\n# Print the histograms\nprint(histograms)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create histograms with density plots for continuous variables\nhistograms <- ggplot(contin_col_HA_Long_Yes, aes(x = Value, fill = Age_Grp )) + \n  geom_histogram(binwidth = 1, alpha = 0.8) + \n  theme_minimal() + \n  labs(title = \"Histograms of Continuous Fields\", x = \"Value\", y = \"Frequency\")+\n  facet_wrap(~ Field, scales = \"free\") \n\n# Print the histograms\nprint(histograms)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n### visualising using density plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Adding density plot\nggplot(HA, aes(x = Stress_Levels)) +\n  geom_histogram(aes(y = ..density..), binwidth = 1, fill = \"blue\", alpha = 0.5) +\n  geom_density(color = \"red\", size = 1) +\n  labs(title = \"Histogram and Density Plot of Stress Levels\", x = \"Stress Levels\", y = \"Density\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n### Chi Square\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbarstats(HA, \n           x=Age_Grp,\n           y=Heart_Attack_Occurrence)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggbarstats(HA, \n           x=Event_Grp,\n           y=Region)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggbarstats(HA_youth, \n           x= Heart_Attack_Occurrence,\n           y=BMI_cat)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select categorical columns\ncategorical_columns <- HA_youth %>% select(where(~is.character(.) || is.factor(.)))\n\n# Function to perform Chi-Square test and visualize the results\nanalyze_association <- function(data, x, y) {\n  # Perform Chi-Square test\n  table <- table(data[[x]], data[[y]])\n  chi_test <- chisq.test(table)\n  \n  # Print Chi-Square test results\n  print(paste(\"Chi-Square Test between\", x, \"and\", y))\n  print(chi_test)\n  \n  # Visualize the results using bar plot\n  plot <- ggplot(HA_youth, aes_string(x = x, fill = y)) +\n    geom_bar(position = \"dodge\") +\n    labs(title = paste(\"Bar Plot of\", x, \"vs\", y, \"\\nChi-Square p-value:\", format(chi_test$p.value, digits=4)),\n         x = x,\n         y = \"Count\") +\n    theme_bw()\n  \n  print(plot)\n}\n\n# Analyze association for each categorical column with Event_Grp\nfor (column in colnames(categorical_columns)) {\n  if (column != \"Heart_Attack_Occurrence\") { # Skip Event_Grp column itself\n    analyze_association(HA_youth, \"Heart_Attack_Occurrence\", column)\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Gender\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.0027295, df = 1, p-value = 0.9583\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Region\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.12335, df = 1, p-value = 0.7254\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Smoking_History\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.084801, df = 1, p-value = 0.7709\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Diabetes_History\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 7.2967, df = 1, p-value = 0.006908\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Hypertension_History\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 1.3112, df = 1, p-value = 0.2522\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Physical_Activity\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.27734, df = 2, p-value = 0.8705\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Diet_Quality\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 2.9799, df = 2, p-value = 0.2254\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Alcohol_Consumption\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 3.9517, df = 3, p-value = 0.2667\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-8.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Family_History\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.52143, df = 1, p-value = 0.4702\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-9.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Age_Grp\"\n\n\tChi-squared test for given probabilities\n\ndata:  table\nX-squared = 5658.3, df = 1, p-value < 2.2e-16\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-10.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Event_Grp\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 8591.3, df = 1, p-value < 2.2e-16\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-11.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and BMI_cat\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 8.312, df = 3, p-value = 0.03998\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-12.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and BP_cat\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 2.718, df = 3, p-value = 0.4372\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-13.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Cholesterol_Level_cat\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 3.6477, df = 2, p-value = 0.1614\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-14.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Stress_Level_cat\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 5.3458, df = 2, p-value = 0.06905\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-15.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Attack_Occurrence and Heart_Rate_cat\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.59882, df = 2, p-value = 0.7413\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-16.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(HA, aes(x = Stress_Levels, fill = Heart_Attack_Occurrence)) +  # Map fill to Heart_Attack_Occurrence\n  geom_histogram(aes(y = ..density..), binwidth = 1, alpha = 0.5, position = \"identity\") +  # Adjust position for overlap\n  geom_density(color = \"red\", size = 1, alpha = 0.3) +  # Density plot with transparency\n  labs(title = \"Histogram and Density Plot of Stress Levels\",\n       x = \"Stress Levels\",\n       y = \"Density\") +\n  theme_minimal(base_size = 14) +  # Improve overall theme and font size\n  scale_fill_brewer(palette = \"Set2\", name = \"Heart Attack Occurrence\") +  # Use a color palette for filling\n  theme(legend.position = \"top\")  # Position the legend at the top\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create individual boxplots for each continuous field\n#individual_boxplots <- \n  #ggplot(HA, aes(x = Field, y = Value, fill = Heart_Attack_Occurrence)) +\n  #geom_boxplot() +\n  #facet_wrap(~ Field, scales = \"free\") +\n  #theme_minimal() +\n  #labs(title = \"Boxplots of Continuous Fields\",\n       #x = \"Field\",\n       #y = \"Value\")\n\n# Print the individual boxplots\n#print(individual_boxplots)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(HA_Yes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age          Gender             Region          Smoking_History   \n Min.   :18.0   Length:2156        Length:2156        Length:2156       \n 1st Qu.:30.0   Class :character   Class :character   Class :character  \n Median :40.0   Mode  :character   Mode  :character   Mode  :character  \n Mean   :40.9                                                           \n 3rd Qu.:52.0                                                           \n Max.   :63.0                                                           \n Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity \n Length:2156        Length:2156          Min.   :105.2     Length:2156       \n Class :character   Class :character     1st Qu.:179.1     Class :character  \n Mode  :character   Mode  :character     Median :199.5     Mode  :character  \n                                         Mean   :198.9                       \n                                         3rd Qu.:219.5                       \n                                         Max.   :311.2                       \n Diet_Quality       Alcohol_Consumption Stress_Levels         BMI        \n Length:2156        Length:2156         Min.   : 0.000   Min.   : 9.435  \n Class :character   Class :character    1st Qu.: 3.503   1st Qu.:21.712  \n Mode  :character   Mode  :character    Median : 4.873   Median :24.784  \n                                        Mean   : 4.863   Mean   :24.904  \n                                        3rd Qu.: 6.185   3rd Qu.:28.042  \n                                        Max.   :10.000   Max.   :42.630  \n   Heart_Rate      Systolic_BP      Diastolic_BP    Family_History    \n Min.   : 34.36   Min.   : 65.71   Min.   : 44.30   Length:2156       \n 1st Qu.: 62.88   1st Qu.:109.74   1st Qu.: 73.23   Class :character  \n Median : 70.00   Median :119.27   Median : 80.19   Mode  :character  \n Mean   : 69.86   Mean   :119.68   Mean   : 80.11                     \n 3rd Qu.: 76.51   3rd Qu.:130.22   3rd Qu.: 86.94                     \n Max.   :102.94   Max.   :167.81   Max.   :113.85                     \n Heart_Attack_Occurrence   Age_Grp           Event_Grp        \n Length:2156             Length:2156        Length:2156       \n Class :character        Class :character   Class :character  \n Mode  :character        Mode  :character   Mode  :character  \n                                                              \n                                                              \n                                                              \n   BMI_cat             BP_cat          Cholesterol_Level_cat Stress_Level_cat  \n Length:2156        Length:2156        Length:2156           Length:2156       \n Class :character   Class :character   Class :character      Class :character  \n Mode  :character   Mode  :character   Mode  :character      Mode  :character  \n                                                                               \n                                                                               \n                                                                               \n Heart_Attack_Occurrence_num Heart_Rate_cat    \n Min.   :1                   Length:2156       \n 1st Qu.:1                   Class :character  \n Median :1                   Mode  :character  \n Mean   :1                                     \n 3rd Qu.:1                                     \n Max.   :1                                     \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=HA,\n       aes(x =  Alcohol_Consumption, y = Cholesterol_Level, color =Heart_Attack_Occurrence )) +\n    geom_boxplot()+\n  facet_wrap(~ Age_Grp)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=HA_Yes,\n       aes(x = Diet_Quality, y = BMI, color = Age_Grp)) +\n    geom_boxplot()+\n  facet_wrap(~ Region)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#| fig-width: 24 #to widen the space\n#| fig-height: 24 #to lengthen the graph\nggplot(HA_youth, \n       aes(x = Heart_Attack_Occurrence, y = BMI)) +\n  stat_halfeye(adjust = 0.5,\n               justification = -0.01,\n               .width = 0.01,\n               point_colour = NA, \n               size=0.01) +\n  geom_boxplot(width = .05,\n               outlier.shape = NA) +\n  stat_dots(side = \"left\", \n            justification = 1.2, \n            binwidth = .5,\n            dotsize = .1)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nscatter_plot <- ggplot(HA, aes(x = Cholesterol_Level, y = BMI, color = Heart_Attack_Occurrence)) +\n  geom_point(size = 2, alpha = 0.5) +  # Adjust point size and transparency\n  labs(title = \"Scatter Plot of Stress Levels vs. BMI\",\n       x = \"Stress Levels\",\n       y = \"BMI\",\n       color = \"Heart Attack Occurrence\") +  # Add title and labels\n  theme_minimal(base_size = 14) +  # Use a clean theme with larger base font size\n  scale_color_manual(values = c(\"blue\", \"red\"))  # Customize colors if needed\n\n# Print the scatter plot\nprint(scatter_plot)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Select only continuous (numeric) columns along with Heart_Attack_Occurrence\ncontinuous_columns <- HA %>% \n  select(where(is.numeric), Heart_Attack_Occurrence)\n\n# Step 2: Reshape the data to long format\nlong_data <- continuous_columns %>%\n  pivot_longer(-Heart_Attack_Occurrence, names_to = \"Variable\", values_to = \"Value\")\n\n# Step 3: Create scatter plots for each continuous variable against Heart_Attack_Occurrence\nscatter_plot <- ggplot(long_data, aes(x = Value, y = as.numeric(Heart_Attack_Occurrence), color = Heart_Attack_Occurrence)) +\n  geom_point(alpha = 0.7, size = 2) +  # Adjust point size and transparency\n  facet_wrap(~ Variable, scales = \"free\") +  # Create facets for each variable\n  labs(title = \"Scatter Plots of Continuous Variables by Heart Attack Occurrence\",\n       x = \"Value\",\n       y = \"Heart Attack Occurrence (0 = No, 1 = Yes)\") +  # y-axis represents occurrence\n  theme_minimal(base_size = 14) +  # Clean theme\n  scale_color_manual(values = c(\"blue\", \"red\"))  # Customize colors for heart attack occurrence\n\n# Print the scatter plots\nprint(scatter_plot)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Print the scatter plots\nprint(scatter_plot)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-31-2.png){width=672}\n:::\n:::\n\n\n\n### Inspiration\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(HA, aes(x = Smoking_History, fill = Heart_Attack_Occurrence)) +\n  geom_bar(position = \"fill\") +\n  labs(title = \"Smoking History vs Heart Attack Occurrence\", \n       y = \"Proportion\", \n       x = \"Smoking History\") +\n  scale_fill_manual(values = c(\"lightblue\", \"salmon\"), name = \"Heart Attack Occurrence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n### Anova\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = HA_youth,\n  x = Heart_Attack_Occurrence, \n  y = Stress_Levels,\n  type = \"p\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"s\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = HA_youth,\n  x = Heart_Attack_Occurrence, \n  y = BMI,\n  type = \"p\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"s\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n\n\n\n::: callout-note\n\nThe very small effect size (Hedges' g = 0.04) suggests that although the difference is statistically significant, it may not be practically relevant. In other words, the difference in means may not be large enough to have meaningful implications in a real-world context.\n\n:::\n\n### Model building\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Heart_Attack_Occurrence_num ~ Cholesterol_Level_cat + BMI_cat + Diabetes_History, data = HA_youth)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Heart_Attack_Occurrence_num ~ Cholesterol_Level_cat + \n    BMI_cat + Diabetes_History, data = HA_youth)\n\nCoefficients:\n                   (Intercept)  Cholesterol_Level_catDesirable  \n                      0.100475                       -0.001157  \n     Cholesterol_Level_catHigh                    BMI_catObese  \n                     -0.021622                       -0.025376  \n             BMI_catOverweight              BMI_catUnderweight  \n                     -0.005984                       -0.015551  \n           Diabetes_HistoryYes  \n                      0.021381  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_n <- check_normality(model)\nplot(check_n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_h <- check_heteroscedasticity(model)\n\nplot(check_h)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(model)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\n\n### Conclusion:\n\nThe health crsis of heart attack is largely depended on the possibility\n",
    "supporting": [
      "Take-home_Ex_01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}