{
  "hash": "2c564aa7f72b4705bbdb338694e334f9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Exercise 01\"\nauthor: \"Dew Stella Chan\"\ndate: \"2025-02-01\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\nThis quota document shows the visual analytics conducted for the Take Home Exercise 01, The data set chosen is the [Heart Attack in Japan Youth Vs Adult](https://www.kaggle.com/code/radhikaarajdev/heart-attack-risk-youth-vs-adults-in-japan) from Kaggle.\n\n## Required Task\n\nThe main task is to develop graphical visuals for a media company on an article for the possible factors leading to heart attack trends in Japanese Youth.\n\nThe plan is to carry out exploratory and confirmatory data analysis to confirm the observed trend before doing up the visuals required for the graphic.\n\nThe goal is to find out if there are any observable trends and health or lifestyle factors leading to the occurrence of heart attack in Japanese youth.\n\nFor the purpose of this analysis, I define Japanese youth as individuals under the age of 35, following the definition provided in the article on [Youth Employment Policies in Japan](https://www.jil.go.jp/english/jli/documents/2023/041-05.pdf). The data set is catogrised into 4 main groups as follows:\n\n1)  Youths who have experienced a heart attack (interest group),\n2)  Youths who have not experienced a heart attack,\n3)  Adults who have experienced a heart attack,\n4)  Adults who have not experienced a heart attack.\n\nPopulation with age above 65, they will be omitted from this study as age above 65 and above are considered as elderly based on the [Wikipedia.](https://en.wikipedia.org/wiki/Aging_of_Japan#:~:text=Article,as%20South%20Korea%20and%20China.)\n\n## 1.0 Loading of Packages\n\nThe following code chunk indicates the list of packages used for this Take Home Exercise 01.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(haven, SmartEDA, tidyverse, tidymodels, ggdist, ggridges, ggthemes,\n               colorspace, gridExtra, ggstatsplot, GGally, \n               readxl, performance, parameters, car,aod, ggExtra, ggiraph, corrplot)\n```\n:::\n\n\n\n## 2.0 Importing of Data and Data Preparation.\n\n### 2.1 Importing data.\n\nAs the data is in csv file format, the data is loaded using read_csv function.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheart <- read_csv(\"data/Ex01/japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\n### 2.2 Data Preparation\n\nAs the metadata did not specify the data in the extra column 1 to 15, hence we will not be able the data in the \"Extra_column 1 to 15\"\n\nThe first step of data preparation is to remove them first, and remove population who are above 64.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheart <- heart %>% select (1:17) %>% filter (Age < 65)\n```\n:::\n\n\n\nThe summary and head functions are used to view and examine the data before proceeding further.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(heart)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age          Gender             Region          Smoking_History   \n Min.   :18.0   Length:22671       Length:22671       Length:22671      \n 1st Qu.:29.0   Class :character   Class :character   Class :character  \n Median :41.0   Mode  :character   Mode  :character   Mode  :character  \n Mean   :40.9                                                           \n 3rd Qu.:53.0                                                           \n Max.   :64.0                                                           \n Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity \n Length:22671       Length:22671         Min.   : 80.02    Length:22671      \n Class :character   Class :character     1st Qu.:179.45    Class :character  \n Mode  :character   Mode  :character     Median :199.72    Mode  :character  \n                                         Mean   :199.83                      \n                                         3rd Qu.:220.10                      \n                                         Max.   :311.24                      \n Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       \n Length:22671       Length:22671        Min.   : 0.000   Min.   : 5.58  \n Class :character   Class :character    1st Qu.: 3.637   1st Qu.:21.64  \n Mode  :character   Mode  :character    Median : 4.973   Median :24.97  \n                                        Mean   : 4.988   Mean   :25.00  \n                                        3rd Qu.: 6.337   3rd Qu.:28.39  \n                                        Max.   :10.000   Max.   :44.12  \n   Heart_Rate      Systolic_BP     Diastolic_BP    Family_History    \n Min.   : 30.59   Min.   : 63.1   Min.   : 39.95   Length:22671      \n 1st Qu.: 63.23   1st Qu.:109.8   1st Qu.: 73.23   Class :character  \n Median : 69.92   Median :119.9   Median : 80.11   Mode  :character  \n Mean   : 69.93   Mean   :120.0   Mean   : 80.03                     \n 3rd Qu.: 76.63   3rd Qu.:130.2   3rd Qu.: 86.78                     \n Max.   :108.78   Max.   :176.6   Max.   :117.66                     \n Heart_Attack_Occurrence\n Length:22671           \n Class :character       \n Mode  :character       \n                        \n                        \n                        \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead (heart)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 17\n    Age Gender Region Smoking_History Diabetes_History Hypertension_History\n  <dbl> <chr>  <chr>  <chr>           <chr>            <chr>               \n1    56 Male   Urban  Yes             No               No                  \n2    46 Male   Rural  Yes             No               No                  \n3    32 Female Urban  No              No               No                  \n4    60 Female Rural  No              No               No                  \n5    25 Female Rural  No              No               No                  \n6    38 Female Urban  Yes             No               No                  \n# ℹ 11 more variables: Cholesterol_Level <dbl>, Physical_Activity <chr>,\n#   Diet_Quality <chr>, Alcohol_Consumption <chr>, Stress_Levels <dbl>,\n#   BMI <dbl>, Heart_Rate <dbl>, Systolic_BP <dbl>, Diastolic_BP <dbl>,\n#   Family_History <chr>, Heart_Attack_Occurrence <chr>\n```\n\n\n:::\n:::\n\n\n\n### 2.3 Check for missing values\n\nis.na function is used to check if the data contain any missing values,if there are, they are being added.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(heart))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Age                  Gender                  Region \n                      0                       0                       0 \n        Smoking_History        Diabetes_History    Hypertension_History \n                      0                       0                       0 \n      Cholesterol_Level       Physical_Activity            Diet_Quality \n                      0                       0                       0 \n    Alcohol_Consumption           Stress_Levels                     BMI \n                      0                       0                       0 \n             Heart_Rate             Systolic_BP            Diastolic_BP \n                      0                       0                       0 \n         Family_History Heart_Attack_Occurrence \n                      0                       0 \n```\n\n\n:::\n:::\n\n\n\nAfter removing the Extra columns, we continue by examining again the data using the summary and head functions to ensure that the extra columns are successfully removed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(heart)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age          Gender             Region          Smoking_History   \n Min.   :18.0   Length:22671       Length:22671       Length:22671      \n 1st Qu.:29.0   Class :character   Class :character   Class :character  \n Median :41.0   Mode  :character   Mode  :character   Mode  :character  \n Mean   :40.9                                                           \n 3rd Qu.:53.0                                                           \n Max.   :64.0                                                           \n Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity \n Length:22671       Length:22671         Min.   : 80.02    Length:22671      \n Class :character   Class :character     1st Qu.:179.45    Class :character  \n Mode  :character   Mode  :character     Median :199.72    Mode  :character  \n                                         Mean   :199.83                      \n                                         3rd Qu.:220.10                      \n                                         Max.   :311.24                      \n Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       \n Length:22671       Length:22671        Min.   : 0.000   Min.   : 5.58  \n Class :character   Class :character    1st Qu.: 3.637   1st Qu.:21.64  \n Mode  :character   Mode  :character    Median : 4.973   Median :24.97  \n                                        Mean   : 4.988   Mean   :25.00  \n                                        3rd Qu.: 6.337   3rd Qu.:28.39  \n                                        Max.   :10.000   Max.   :44.12  \n   Heart_Rate      Systolic_BP     Diastolic_BP    Family_History    \n Min.   : 30.59   Min.   : 63.1   Min.   : 39.95   Length:22671      \n 1st Qu.: 63.23   1st Qu.:109.8   1st Qu.: 73.23   Class :character  \n Median : 69.92   Median :119.9   Median : 80.11   Mode  :character  \n Mean   : 69.93   Mean   :120.0   Mean   : 80.03                     \n 3rd Qu.: 76.63   3rd Qu.:130.2   3rd Qu.: 86.78                     \n Max.   :108.78   Max.   :176.6   Max.   :117.66                     \n Heart_Attack_Occurrence\n Length:22671           \n Class :character       \n Mode  :character       \n                        \n                        \n                        \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(heart)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 17\n    Age Gender Region Smoking_History Diabetes_History Hypertension_History\n  <dbl> <chr>  <chr>  <chr>           <chr>            <chr>               \n1    56 Male   Urban  Yes             No               No                  \n2    46 Male   Rural  Yes             No               No                  \n3    32 Female Urban  No              No               No                  \n4    60 Female Rural  No              No               No                  \n5    25 Female Rural  No              No               No                  \n6    38 Female Urban  Yes             No               No                  \n# ℹ 11 more variables: Cholesterol_Level <dbl>, Physical_Activity <chr>,\n#   Diet_Quality <chr>, Alcohol_Consumption <chr>, Stress_Levels <dbl>,\n#   BMI <dbl>, Heart_Rate <dbl>, Systolic_BP <dbl>, Diastolic_BP <dbl>,\n#   Family_History <chr>, Heart_Attack_Occurrence <chr>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheart <- heart %>%\n  mutate(Age_Grp = ifelse(Age > 35, \"Adult\", \"Youth\"))\n```\n:::\n\n\n\n### 2.4 Transforming the data to the 4 main sub group.\n\nIt was observed that the data consist two types of variables: namely continuous and categorical.\n\nAs mentioned in section 1.0, the data will be categorised into the 4 main group.\n\nGiven that the continuous data are consist of variables such as heart rate, cholesterol level, Systolic and Diastolic Blood Pressure, they are being categorized to established category . For this purpose of the analysis, we will use the range indicate in the following sites and with the help of Microsoft Co-pilot.\n\n1.  [Body Mass Index (BMI)](https://www.cdc.gov/bmi/adult-calculator/bmi-categories.html?form=MG0AV3)\n\n2.  [Blood pressure (BP)](https://www.heart.org/en/health-topics/high-blood-pressure?form=MG0AV3)\n\n3.  [Cholesterol Levels](https://www.heart.org/en/health-topics/cholesterol/about-cholesterol/what-your-cholesterol-levels-mean)\n\n4.  [Heart Rate](https://www.mayoclinic.org/healthy-lifestyle/fitness/expert-answers/heart-rate/faq-20057979)\n\nUsing the following codes, the data are categorised into 4 main groups and the health indicators are categorized into the established data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHA <- heart %>%\n  mutate(Event_Grp = ifelse(Age_Grp == \"Adult\" & Heart_Attack_Occurrence == \"Yes\", \"Adult_HA\",\n                    ifelse(Age_Grp == \"Adult\" & Heart_Attack_Occurrence == \"No\", \"Adult_No_HA\",\n                    ifelse(Age_Grp == \"Youth\" & Heart_Attack_Occurrence == \"Yes\", \"Youth_HA\",\n                    ifelse(Age_Grp == \"Youth\" & Heart_Attack_Occurrence == \"No\", \"Youth_No_HA\",NA)))))\n\nHA <- HA %>%\n  mutate(BMI_cat = case_when( \n    BMI < 18.5 ~ \"Underweight\",\n    BMI >= 18.5 & BMI < 25 ~ \"Normal\",\n    BMI >= 25 & BMI < 30 ~ \"Overweight\",\n    BMI >= 30 ~ \"Obese\",\n    TRUE ~ NA_character_\n  ))\n\nHA <- HA %>%\n  mutate(BP_cat = case_when(\n    Systolic_BP < 120 & Diastolic_BP < 80 ~ \"Normal\",\n    (Systolic_BP >= 120 & Systolic_BP < 130) & Diastolic_BP < 80 ~ \"Elevated\",\n    (Systolic_BP >= 130 & Systolic_BP < 140) | (Diastolic_BP >= 80 & Diastolic_BP < 90) ~ \"High Stage 1\",\n    Systolic_BP >= 140 | Diastolic_BP >= 90 ~ \"High Stage 2\",\n    TRUE ~ NA_character_\n  ))\n\nHA <- HA %>%\n  mutate(Cholesterol_Level_cat = case_when(\n    Cholesterol_Level < 200 ~ \"Desirable\",\n    Cholesterol_Level >= 200 & Cholesterol_Level < 240~ \"Borderline High\",\n    Cholesterol_Level >= 240 ~ \"High\",\n    TRUE ~ NA_character_\n  ))\n\nHA <- HA %>%\n  mutate(Stress_Level_cat = case_when(\n    Stress_Levels < 3 ~ \"Low\",\n    Stress_Levels >= 3 & Stress_Levels < 6 ~ \"Moderate\",\n    Stress_Levels >= 6 ~ \"High\",\n    TRUE ~ NA_character_\n  ))\n\n\nHA <- HA %>% \n  mutate(Heart_Rate_cat = case_when(\n    Heart_Rate < 70 ~ \"Below Normal\",\n    Heart_Rate >=  70 & Heart_Rate <= 100 ~ \"Normal\",\n    Heart_Rate  > 100 ~ \"Elevated\",\n    TRUE ~ NA_character_\n  ))\n```\n:::\n\n\n\nExamine of missing data after recoding\n\nnote that there are 277 recids of BMI data and 108 of chelesterol records not being\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmissing_values <- colSums(is.na(HA))\nprint(missing_values)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Age                  Gender                  Region \n                      0                       0                       0 \n        Smoking_History        Diabetes_History    Hypertension_History \n                      0                       0                       0 \n      Cholesterol_Level       Physical_Activity            Diet_Quality \n                      0                       0                       0 \n    Alcohol_Consumption           Stress_Levels                     BMI \n                      0                       0                       0 \n             Heart_Rate             Systolic_BP            Diastolic_BP \n                      0                       0                       0 \n         Family_History Heart_Attack_Occurrence                 Age_Grp \n                      0                       0                       0 \n              Event_Grp                 BMI_cat                  BP_cat \n                      0                       0                       0 \n  Cholesterol_Level_cat        Stress_Level_cat          Heart_Rate_cat \n                      0                       0                       0 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(HA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age          Gender             Region          Smoking_History   \n Min.   :18.0   Length:22671       Length:22671       Length:22671      \n 1st Qu.:29.0   Class :character   Class :character   Class :character  \n Median :41.0   Mode  :character   Mode  :character   Mode  :character  \n Mean   :40.9                                                           \n 3rd Qu.:53.0                                                           \n Max.   :64.0                                                           \n Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity \n Length:22671       Length:22671         Min.   : 80.02    Length:22671      \n Class :character   Class :character     1st Qu.:179.45    Class :character  \n Mode  :character   Mode  :character     Median :199.72    Mode  :character  \n                                         Mean   :199.83                      \n                                         3rd Qu.:220.10                      \n                                         Max.   :311.24                      \n Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       \n Length:22671       Length:22671        Min.   : 0.000   Min.   : 5.58  \n Class :character   Class :character    1st Qu.: 3.637   1st Qu.:21.64  \n Mode  :character   Mode  :character    Median : 4.973   Median :24.97  \n                                        Mean   : 4.988   Mean   :25.00  \n                                        3rd Qu.: 6.337   3rd Qu.:28.39  \n                                        Max.   :10.000   Max.   :44.12  \n   Heart_Rate      Systolic_BP     Diastolic_BP    Family_History    \n Min.   : 30.59   Min.   : 63.1   Min.   : 39.95   Length:22671      \n 1st Qu.: 63.23   1st Qu.:109.8   1st Qu.: 73.23   Class :character  \n Median : 69.92   Median :119.9   Median : 80.11   Mode  :character  \n Mean   : 69.93   Mean   :120.0   Mean   : 80.03                     \n 3rd Qu.: 76.63   3rd Qu.:130.2   3rd Qu.: 86.78                     \n Max.   :108.78   Max.   :176.6   Max.   :117.66                     \n Heart_Attack_Occurrence   Age_Grp           Event_Grp        \n Length:22671            Length:22671       Length:22671      \n Class :character        Class :character   Class :character  \n Mode  :character        Mode  :character   Mode  :character  \n                                                              \n                                                              \n                                                              \n   BMI_cat             BP_cat          Cholesterol_Level_cat Stress_Level_cat  \n Length:22671       Length:22671       Length:22671          Length:22671      \n Class :character   Class :character   Class :character      Class :character  \n Mode  :character   Mode  :character   Mode  :character      Mode  :character  \n                                                                               \n                                                                               \n                                                                               \n Heart_Rate_cat    \n Length:22671      \n Class :character  \n Mode  :character  \n                   \n                   \n                   \n```\n\n\n:::\n:::\n\n\n\n### 2.5 Re-coding Catological data for Logistic Regression\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHA <- HA %>%\n  mutate(Heart_Attack_Occurrence_num = case_when(\n      Heart_Attack_Occurrence == \"Yes\" ~ 1,\n      Heart_Attack_Occurrence == \"No\" ~ 0,\n      TRUE ~ NA_real_),\n    Gender_num = case_when(\n      Gender == \"Male\" ~ 1,\n      Gender == \"Female\" ~ 0,\n      TRUE ~ NA_real_),\n    Region_num = case_when(\n      Region == \"Urban\" ~ 1,\n      Region == \"Rural\" ~ 0,\n      TRUE ~ NA_real_),\n    Smoking_History_num = case_when(\n      Smoking_History == \"Yes\" ~ 1,\n      Smoking_History == \"No\" ~ 0,\n      TRUE ~ NA_real_),\n    Diabetes_History_num = case_when(\n      Diabetes_History == \"Yes\" ~ 1,\n      Diabetes_History == \"No\" ~ 0,\n      TRUE ~ NA_real_),\n    Hypertension_History_num = case_when(\n      Hypertension_History == \"Yes\" ~ 1,\n      Hypertension_History == \"No\" ~ 0,\n      TRUE ~ NA_real_),\n    Family_History_num = case_when(\n      Family_History == \"Yes\" ~ 1,\n      Family_History == \"No\" ~ 0,\n      TRUE ~ NA_real_),\n    Physical_Activity_num = case_when(\n      Physical_Activity == \"High\" ~ 0,\n      Physical_Activity == \"Moderate\" ~ 1,\n      Physical_Activity == \"Low\" ~ 2,\n      TRUE ~ NA_real_),\n    Diet_Quality_num = case_when(\n      Diet_Quality == \"Good\" ~ 0,\n      Diet_Quality == \"Average\" ~ 1,\n      Diet_Quality == \"Poor\" ~ 2,\n      TRUE ~ NA_real_),\n    Alcohol_Consumption_num = case_when(\n      Alcohol_Consumption == \"None\" ~ 0,\n      Alcohol_Consumption == \"Low\" ~ 1,\n      Alcohol_Consumption == \"Moderate\" ~ 2,\n      Alcohol_Consumption == \"High\" ~ 3,\n      TRUE ~ NA_real_),\n    Stress_Level_cat_num = case_when(\n      Stress_Level_cat == \"Low\" ~ 0,\n      Stress_Level_cat == \"Moderate\" ~ 1,\n      Stress_Level_cat == \"High\" ~ 2,\n      TRUE ~ NA_real_),\n    BMI_cat_num = case_when(\n      BMI_cat == \"Underweight\" ~ 0,\n      BMI_cat == \"Normal\" ~ 1,\n      BMI_cat == \"Overweight\" ~ 2,\n      BMI_cat == \"Obese\" ~ 2,\n      TRUE ~ NA_real_),\n    Heart_Rate_cat_num = case_when(\n      Heart_Rate_cat  == \"Below Normal\" ~ 0,\n      Heart_Rate_cat  == \"Normal\" ~ 1,\n      Heart_Rate_cat  == \"Elevated\" ~ 2,\n      TRUE ~ NA_real_),\n    BP_cat_num = case_when(\n      BP_cat  == \"Normal\" ~ 0,\n      BP_cat  == \"Elevated\" ~ 1,\n      BP_cat  == \"High Stage 1\" ~ 2,\n      BP_cat  == \"High Stage 2\" ~ 3,\n      TRUE ~ NA_real_),\n    Cholesterol_Level_cat_num = case_when(\n      Cholesterol_Level_cat  == \"Desirable\" ~ 0,\n      Cholesterol_Level_cat == \"Borderline High\" ~ 1,\n      Cholesterol_Level_cat  == \"High\" ~ 2,\n      TRUE ~ NA_real_))\n```\n:::\n\n\n\nChecking of data after re-coding.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmissing_values <- colSums(is.na(HA))\nprint(missing_values)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        Age                      Gender \n                          0                           0 \n                     Region             Smoking_History \n                          0                           0 \n           Diabetes_History        Hypertension_History \n                          0                           0 \n          Cholesterol_Level           Physical_Activity \n                          0                           0 \n               Diet_Quality         Alcohol_Consumption \n                          0                           0 \n              Stress_Levels                         BMI \n                          0                           0 \n                 Heart_Rate                 Systolic_BP \n                          0                           0 \n               Diastolic_BP              Family_History \n                          0                           0 \n    Heart_Attack_Occurrence                     Age_Grp \n                          0                           0 \n                  Event_Grp                     BMI_cat \n                          0                           0 \n                     BP_cat       Cholesterol_Level_cat \n                          0                           0 \n           Stress_Level_cat              Heart_Rate_cat \n                          0                           0 \nHeart_Attack_Occurrence_num                  Gender_num \n                          0                           0 \n                 Region_num         Smoking_History_num \n                          0                           0 \n       Diabetes_History_num    Hypertension_History_num \n                          0                           0 \n         Family_History_num       Physical_Activity_num \n                          0                           0 \n           Diet_Quality_num     Alcohol_Consumption_num \n                          0                           0 \n       Stress_Level_cat_num                 BMI_cat_num \n                          0                           0 \n         Heart_Rate_cat_num                  BP_cat_num \n                          0                           0 \n  Cholesterol_Level_cat_num \n                          0 \n```\n\n\n:::\n:::\n\n\n\n### 2.6 Prepare of varies data frame for easy of infographic.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHA_Yes <- filter(HA, Heart_Attack_Occurrence == \"Yes\")\nHA_adult <- filter(HA, Age_Grp == \"Adult\")\nHA_youth <- filter(HA, Age_Grp == \"Youth\")\nHA_youth_yes <- filter(HA_youth, Heart_Attack_Occurrence == \"Yes\")\n```\n:::\n\n\n\n## 3.0 Exploratory Data Analysis (EDA)\n\nWe start off by understanding the distribution of the variables and examine if there were any observable trends to be tested out using confirmatory analysis.\n\n### 3.1 Visualising Distribution of the Categorical Variables\n\nThe aim of this task is to examine if there are any trends in categorical data in the occurrence of heart attack in Japanese population.\n\nThe code below is extract our the categorical data and summaries into the occurrence of heart attack by Heart occurrence Age Groups and Event Groups.\n\nThe data are processed using the following codes to allow flexibility when exploring the data set.Hence HA is being used instead of the subgroups. Those data sets would be used in the subsequent visuslisation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncategorical_columns <- HA %>% select(where(~is.character(.x) || is.factor(.x)))\n\ncount_occurrences <- categorical_columns %>%\n  pivot_longer(cols= - c(Heart_Attack_Occurrence, Age_Grp, Event_Grp), names_to = \"Category\", values_to = \"Value\") %>%\n  group_by(Category, Value, Age_Grp, Heart_Attack_Occurrence, Event_Grp) %>%\n  summarise(Occurrences = n(), .groups = 'drop')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbar_plots <- count_occurrences %>%\n  ggplot(aes(x = Value, y = Occurrences, fill = Heart_Attack_Occurrence)) + \n  geom_bar(stat = \"identity\", position = position_dodge()) +  \n  facet_wrap(~ Category, scales = \"free\") +\n  theme_minimal() +\n  labs(title = \"Distribution of Categorical Variables of The Study Population.\",\n       x = \"Unique Values\",\n       y = \"Count\") +\n  scale_fill_manual(values = c(\"Yes\" = \"red\", \"No\" = \"#4682B4\"))\n\nbar_plots\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-17-1.png){width=1920}\n:::\n:::\n\n\n\n::: Callout-note\nThe above chart shows the data distribution for the categorical variables of the data set.\n\nIt includes the entire data set of the risk factors with whom had have heart attack verse whom had not have attack in Japan in all age group.\n\nBefore visualizing the data, one would expect [risk factors](https://www.mayoclinic.org/diseases-conditions/heart-attack/symptoms-causes/syc-20373106) such as high cholesterol level, elevated heart rate and with smoking history, will likely result in more occurrence of heart attack in but solely by looking at the distribution of the data, this may not be true.\n\nThe main take away from the analysis is that it seems there is no **sole risk factor** which will lead to heart attack with the Japanese population sampled for this data set.\n:::\n\n#### 3.1.1 Closer Examination on the Distribution Categorical Variables in different Age group in Youth vs Adult\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncount_occurrences_yes <- filter(count_occurrences,  Heart_Attack_Occurrence == \"Yes\")\n\nbar_plots_yes <- count_occurrences_yes %>%\n  ggplot(aes(x = Value, y = Occurrences, fill = Age_Grp)) + \n  geom_bar(stat = \"identity\", position = position_dodge()) + \n  facet_wrap(~ Category, scales = \"free\") +\n  theme_minimal() +\n  labs(title = \"Distribution of Categorical Variables of subjects with Heart Attack Across Age Groups\",\n       y = \"Count\") +\nscale_fill_manual(values = c(\"Youth\" = \"#FF1493\", \"Adult\" = \"#FFA07A\"))\n\nbar_plots_yes\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-18-1.png){width=1920}\n:::\n:::\n\n\n\n::: Callout-note\nDue to the study population, contains more subjects with heart attack, it is good to visualise the distribution across the age groups with heart attack. This may provide some interesting insights.\n\nThe charts above show the distribution of the categorical variables for study subjects who had heart attack across different age groups.\n\nAt a glance, the general distribution across categorical variables may seem to be similar across both age groups but at a closer examination. the following observations could be seen:\n\n-   BP_cat \"high stage 1\" in adults has higher occurrence in heart attack when compared to youth.\n\n-   In youth, the occurrence of heart attack across gender while in adult a slightly in male verse female.\n\n-   There seems to be have more occurrence in heart attack occurring in urban setting than rural setting.\n\n-   It seem to have association between BMI and heart attack with more slight more occurrence in overweight subjects as compared to other BMI category.\n\n-   It seems that there is association with moderate stress level with high proportion in both age groups.\n\nFrom the distribution, it seems that there is no sole factor which stand out in the youth population which will result in heart attack, confirmatory analysis would be need to confirm the analysis or explanatory model using logistic regression could be carried out to further explain risk factors.\n:::\n\n#### 3.1.2 Closer Examination on the Distribution Categorical Variables in the Youth Age group.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncount_occurrences_youth <- filter(count_occurrences,  Age_Grp == \"Youth\")\n\nbar_plots_yes <- count_occurrences_youth %>%\n  ggplot(aes(x = Value, y = Occurrences, fill = Heart_Attack_Occurrence)) + \n  geom_bar(stat = \"identity\", position = position_dodge()) + \n  facet_wrap(~ Category, scales = \"free\") +\n  theme_minimal() +\n  labs(title = \"Distribution of Categorical Variables of subjects with Heart Attack in Youth\",\n       y = \"Count\") +\nscale_fill_manual(values = c(\"Yes\" = \"#FF1493\", \"No\" = \"#87CEEB\"))\n\nbar_plots_yes\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-19-1.png){width=1920}\n:::\n:::\n\n\n\n::: Callout-note\nSimilar to the bar charts in section 3.1, there is no *sole risk factor* which stands out in the categorical variables which lead to high occurrence in the youth population.\n:::\n\n### 3.2 Visualising Distribution of the Continuous Variables\n\nThe following codes is to prepared the data to plot histogram to visualise the continuous data.\n\nThe data is prepared this manner so that it will provide flexibility in showing data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontin_col_HA <- heart %>% select(where(is.numeric), Heart_Attack_Occurrence, Age_Grp)\n\ncontin_col_HA_youth <- filter(contin_col_HA, Age_Grp == \"Youth\")  \n\ncontin_col_HA_Yes <- filter(contin_col_HA, Heart_Attack_Occurrence == \"Yes\")\n\ncontin_col_HA_Long<-contin_col_HA %>%\n  pivot_longer(cols = -c(Heart_Attack_Occurrence, Age_Grp), names_to = \"Field\", values_to = \"Value\")\n               \ncontin_col_HA_Long_Yes <- filter(contin_col_HA_Long, Heart_Attack_Occurrence == \"Yes\")\n\ncontin_col_HA_Long_youth <- filter(contin_col_HA_Long, Age_Grp == \"Youth\")  \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhistograms_HA <- ggplot(contin_col_HA_Long, aes(x = Value, fill = Heart_Attack_Occurrence )) + \n  geom_histogram(binwidth = 1, alpha = 0.8) + \n  theme_minimal() + \n  labs(title = \"Histograms of Continuous Variables\", y = \"Frequency\")+\n  facet_wrap(~ Field, scales = \"free\") +\n  scale_fill_manual(values = c(\"Yes\" = \"red\", \"No\" = \"#4682B4\"))\n\nhistograms_HA\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-21-1.png){width=960}\n:::\n:::\n\n\n\n::: Callout-note\nTo visualise the continuous variables, the continuous variables were plotted using the Heart data without re-coding. This is to allow us to be able to view this distribution of the continuous variables.\n\nBased on the histogram, the distribution of of the continuous variables for BMI, Cholesterol Level, Diastolic and Systolic blood pressure, stress levels and heart rate seems to be over normal distribution. The overall trend is similar between across the subjects regardless if they had or had not have a heart attack.\n:::\n\n#### 3.2.1 Closer look and the Youth Age Group\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhistograms_HA_youth <- ggplot(contin_col_HA_Long_youth, aes(x = Value, fill = Heart_Attack_Occurrence )) + \n  geom_histogram(binwidth = 1, alpha = 0.8) + \n  theme_minimal() + \n  labs(title = \"Histograms of Continuous Variables\", y = \"Frequency\")+\n  facet_wrap(~ Field, scales = \"free\") +\n  scale_fill_manual(values = c(\"Yes\" = \"#FF1493\", \"No\" = \"#87CEEB\"))\n\nhistograms_HA_youth\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-22-1.png){width=960}\n:::\n:::\n\n\n\n::: Callout-note\nComparing the occurrence of heart attack in youth, it follows the same distribution as the over all data. It was noted that similar to the overall data, there resembles the normality in the BMI, Cholesterol, Diastolic and systolic blood pressure, heart rate and stress levels.\n\nThis maybe logical as these variables are measure of bodily vitals or measurements, and due to homostasis the self regulating ability of the human body it will be normal to be peak in the center.\n\nHence to better understand variables, it may be more meaning for categorszed them into established bench marks such as what if the rest heart rate above 100 is considered as elevated.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#| fig-width: 24 #to widen the space\n#| fig-height: 24 #to lengthen the graph\n\nHA_youth %>%\n  ExpNumViz(target = \"Heart_Attack_Occurrence\",\n            nlim=10,\n            Page=c(2,4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`0`\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n::: Callout-note\nBesides histogram, given that the distribution is resemble normal distribution, boxplot could be useful type of chart to visualise if there are any differences across the variables. It was noted that there maybe slight differences in stress levels between the youth with heart attack verse youth without heart attack.\n:::\n\n## 4.0 Confirmatory Data Analysis (CDA)\n\n### 4.1 Chi Square test for youth data\n\nDue to there is no trend observed by examining the barcharts, the chi square was ran using all variables.\n\nAfter running the above associative test, the following code chunk to carry out the chi-square test to find our variables with association between heart attacks and categorical variables. The following codes on how to perform chi-square is generated using co-pilot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalyze_association <- function(data, x, y) {\n  # Perform Chi-Square test\n  table <- table(data[[x]], data[[y]])\n  chi_test <- chisq.test(table)\n  \n  # Print Chi-Square test results\n  print(paste(\"Chi-Square Test between\", x, \"and\", y))\n  print(chi_test)\n}\n\n# Analyze association for each categorical column with Heart_Attack_Occurrence\nfor (column in colnames(categorical_columns)) {\n  if (!(column %in% c(\"Heart_Attack_Occurrence\", \"Event_Grp\", \"Age_Grp\")))  \n    analyze_association(HA_youth, column, \"Heart_Attack_Occurrence\")\n  }\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Gender and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.058062, df = 1, p-value = 0.8096\n\n[1] \"Chi-Square Test between Region and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.25033, df = 1, p-value = 0.6168\n\n[1] \"Chi-Square Test between Smoking_History and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.16193, df = 1, p-value = 0.6874\n\n[1] \"Chi-Square Test between Diabetes_History and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 7.4232, df = 1, p-value = 0.006439\n\n[1] \"Chi-Square Test between Hypertension_History and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 1.0644, df = 1, p-value = 0.3022\n\n[1] \"Chi-Square Test between Physical_Activity and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.19892, df = 2, p-value = 0.9053\n\n[1] \"Chi-Square Test between Diet_Quality and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 3.2215, df = 2, p-value = 0.1997\n\n[1] \"Chi-Square Test between Alcohol_Consumption and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 3.487, df = 3, p-value = 0.3224\n\n[1] \"Chi-Square Test between Family_History and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.16224, df = 1, p-value = 0.6871\n\n[1] \"Chi-Square Test between BMI_cat and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 8.7346, df = 3, p-value = 0.03304\n\n[1] \"Chi-Square Test between BP_cat and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 3.0918, df = 3, p-value = 0.3777\n\n[1] \"Chi-Square Test between Cholesterol_Level_cat and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 3.9627, df = 2, p-value = 0.1379\n\n[1] \"Chi-Square Test between Stress_Level_cat and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 4.9121, df = 2, p-value = 0.08577\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Rate_cat and Heart_Attack_Occurrence\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.78781, df = 2, p-value = 0.6744\n```\n\n\n:::\n:::\n\n\n\n### 4.2 Significant Test of Association (Dependence) : ggbarstats() methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA_HA_youth_BMI <- ggbarstats(HA_youth, \n           x=BMI_cat,\n           y=Heart_Attack_Occurrence)\n\nA_HA_youth_Dia <- ggbarstats(HA_youth, \n           x=Diabetes_History,\n           y=Heart_Attack_Occurrence)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#| eval: false\n#| fig-width: 120 #to widen the space\n#| fig-height: 120 #to lengthen the graph\n\nPatchwork_sig <- (A_HA_youth_Dia | A_HA_youth_BMI)\n\n\nPatchwork_sig \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\n::: Callout-note\nUsing the ggbarstats, we are able to view the associations between diabetes history and BMI verse heart attack occurrence in youth.\n\nFor **Diabetes history**, it is clear that youth with diabetes history have higher association or may have high risk with heart attack as compared to youth without diabetes in the past.\n\nFor the **BMI category**, while the statistical test seems that BMI category may be significant, however it seems like the proportion of youth with normal BMI may result in high proportion of youth has heart attack. While it is consistent with general knowledge, it is noted the youth who are underweight has slightly less association of having heart attack.\n\nFurther analysis using logistic regression would be required to further understand the relationship.\n:::\n\n### 4.3 Chi Square for subjects with heart attack of the two different age group\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalyze_association <- function(data, x, y) {\n  # Perform Chi-Square test\n  table <- table(data[[x]], data[[y]])\n  chi_test <- chisq.test(table)\n  \n  # Print Chi-Square test results\n  print(paste(\"Chi-Square Test between\", x, \"and\", y))\n  print(chi_test)\n}\n\n# Analyze association for each categorical column with Heart_Attack_Occurrence\nfor (column in colnames(categorical_columns)) {\n  if (!(column %in% c(\"Heart_Attack_Occurrence\", \"Event_Grp\", \"Age_Grp\")))  \n    analyze_association(HA_Yes, column, \"Age_Grp\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Gender and Age_Grp\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 1.4995, df = 1, p-value = 0.2207\n\n[1] \"Chi-Square Test between Region and Age_Grp\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.31905, df = 1, p-value = 0.5722\n\n[1] \"Chi-Square Test between Smoking_History and Age_Grp\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.53203, df = 1, p-value = 0.4658\n\n[1] \"Chi-Square Test between Diabetes_History and Age_Grp\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 4.7694, df = 1, p-value = 0.02897\n\n[1] \"Chi-Square Test between Hypertension_History and Age_Grp\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.012936, df = 1, p-value = 0.9094\n\n[1] \"Chi-Square Test between Physical_Activity and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.93543, df = 2, p-value = 0.6264\n\n[1] \"Chi-Square Test between Diet_Quality and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 1.4703, df = 2, p-value = 0.4794\n\n[1] \"Chi-Square Test between Alcohol_Consumption and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 2.6902, df = 3, p-value = 0.4419\n\n[1] \"Chi-Square Test between Family_History and Age_Grp\"\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table\nX-squared = 0.084369, df = 1, p-value = 0.7715\n\n[1] \"Chi-Square Test between BMI_cat and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.53648, df = 3, p-value = 0.9108\n\n[1] \"Chi-Square Test between BP_cat and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 5.6781, df = 3, p-value = 0.1284\n\n[1] \"Chi-Square Test between Cholesterol_Level_cat and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 1.1245, df = 2, p-value = 0.5699\n\n[1] \"Chi-Square Test between Stress_Level_cat and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.51442, df = 2, p-value = 0.7732\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test between Heart_Rate_cat and Age_Grp\"\n\n\tPearson's Chi-squared test\n\ndata:  table\nX-squared = 0.81758, df = 2, p-value = 0.6645\n```\n\n\n:::\n:::\n\n\n\n::: Callout-note\nBased on chi square test, there no statistically significant variables for the between the categorical variables and age group. Hence the earlier observations in section 3.1.1 are not valid.\n:::\n\n### 4.5 Anova performed on the youth group.\n\nAnova is performed to test the differences in true mean across continous variables for the youth with heart attack and without heart attack. The following code is steamlined with the help of Microsoft co-pilot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nperform_anova <- function(data, group_var, continuous_vars) {\n  results <- list()\n  \n  for (var in continuous_vars) {\n    print(paste(\"Performing ANOVA for\", var, \"by\", group_var))\n    anova_result <- summary(aov(as.formula(paste(var, \"~\", group_var)), data = data))\n    results[[var]] <- anova_result\n    print(anova_result)\n  }\n  \n  return(results)\n}\n\n# List of continuous variables\ncontinuous_vars <- c(\"BMI\", \"Cholesterol_Level\", \"Stress_Levels\", \"Heart_Rate\", \"Systolic_BP\", \"Diastolic_BP\")\n\n# Perform ANOVA for each continuous variable in the Youth group\nanova_results <- perform_anova(contin_col_HA_youth, \"Heart_Attack_Occurrence\", continuous_vars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Performing ANOVA for BMI by Heart_Attack_Occurrence\"\n                          Df Sum Sq Mean Sq F value Pr(>F)\nHeart_Attack_Occurrence    1     36   35.69   1.415  0.234\nResiduals               8764 221033   25.22               \n[1] \"Performing ANOVA for Cholesterol_Level by Heart_Attack_Occurrence\"\n                          Df  Sum Sq Mean Sq F value Pr(>F)\nHeart_Attack_Occurrence    1     707   707.2   0.786  0.375\nResiduals               8764 7883042   899.5               \n[1] \"Performing ANOVA for Stress_Levels by Heart_Attack_Occurrence\"\n                          Df Sum Sq Mean Sq F value Pr(>F)   \nHeart_Attack_Occurrence    1     27   26.77    6.71 0.0096 **\nResiduals               8764  34970    3.99                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n[1] \"Performing ANOVA for Heart_Rate by Heart_Attack_Occurrence\"\n                          Df Sum Sq Mean Sq F value Pr(>F)\nHeart_Attack_Occurrence    1      0    0.24   0.002  0.961\nResiduals               8764 882302  100.67               \n[1] \"Performing ANOVA for Systolic_BP by Heart_Attack_Occurrence\"\n                          Df  Sum Sq Mean Sq F value Pr(>F)\nHeart_Attack_Occurrence    1     202   202.0   0.896  0.344\nResiduals               8764 1977029   225.6               \n[1] \"Performing ANOVA for Diastolic_BP by Heart_Attack_Occurrence\"\n                          Df Sum Sq Mean Sq F value Pr(>F)\nHeart_Attack_Occurrence    1      3    2.54   0.025  0.874\nResiduals               8764 886533  101.16               \n```\n\n\n:::\n:::\n\n\n\n#### 4.5.1 Oneway ANOVA Test: ggbetweenstats() method\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstress <- ggbetweenstats(\n  data = HA_youth,\n  x = Heart_Attack_Occurrence, \n  y = Stress_Levels,\n  type = \"p\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"s\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE\n)\n\nstress\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\nBased on the anova results, there is statistically significant differences in the stress levels between youth with heart attack verse youth whom have not had heart attack.\n\nHowever, it is noted that there small effect size (Hedges' g = 0.09) suggests that although the difference is statistically significant, but the small effect may not may not be large enough to have meaningful implications in a real-world context.\n\nAs the stress level maybe derived from Likert kind of survey, it maybe meaningful to categorise it to the different levels and analyse using logistic regression model. This had been done in section 2.6\n:::\n\n## 5.0 Model building\n\nDue to the lack of observable trends from CDA and EDA, explanatory model is build to further analysis if there are other variables, besides Stress level, BMI categories and Diabetes history, a logistic model is built to further analyse the data set for trends.\n\n### 5.1 Logistic Regression Model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the model\nmodel_log_youth <- glm(Heart_Attack_Occurrence_num  ~ Gender_num + Region_num + Smoking_History_num + Diabetes_History_num + Physical_Activity_num + Diet_Quality_num + Alcohol_Consumption_num + Stress_Level_cat_num + BMI_cat_num + Heart_Rate_cat_num + BP_cat_num +Family_History_num + Cholesterol_Level_cat_num, family = binomial(), data = HA_youth)\n\n# View the summary\nsummary(model_log_youth)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = Heart_Attack_Occurrence_num ~ Gender_num + Region_num + \n    Smoking_History_num + Diabetes_History_num + Physical_Activity_num + \n    Diet_Quality_num + Alcohol_Consumption_num + Stress_Level_cat_num + \n    BMI_cat_num + Heart_Rate_cat_num + BP_cat_num + Family_History_num + \n    Cholesterol_Level_cat_num, family = binomial(), data = HA_youth)\n\nCoefficients:\n                          Estimate Std. Error z value Pr(>|z|)    \n(Intercept)               -1.93838    0.17306 -11.201  < 2e-16 ***\nGender_num                 0.02215    0.07293   0.304  0.76134    \nRegion_num                -0.04617    0.07862  -0.587  0.55700    \nSmoking_History_num        0.03464    0.07954   0.436  0.66320    \nDiabetes_History_num       0.23270    0.08552   2.721  0.00651 ** \nPhysical_Activity_num     -0.01854    0.04703  -0.394  0.69335    \nDiet_Quality_num          -0.08240    0.04909  -1.678  0.09327 .  \nAlcohol_Consumption_num   -0.05436    0.04016  -1.354  0.17585    \nStress_Level_cat_num      -0.11934    0.05435  -2.196  0.02810 *  \nBMI_cat_num               -0.04134    0.05512  -0.750  0.45321    \nHeart_Rate_cat_num         0.05784    0.07258   0.797  0.42557    \nBP_cat_num                 0.02014    0.03454   0.583  0.55997    \nFamily_History_num        -0.03353    0.08030  -0.418  0.67629    \nCholesterol_Level_cat_num -0.07304    0.05659  -1.291  0.19681    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 5509.8  on 8765  degrees of freedom\nResidual deviance: 5488.9  on 8752  degrees of freedom\nAIC: 5516.9\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(coef(model_log_youth))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              (Intercept)                Gender_num                Region_num \n                0.1439365                 1.0223990                 0.9548764 \n      Smoking_History_num      Diabetes_History_num     Physical_Activity_num \n                1.0352488                 1.2620005                 0.9816281 \n         Diet_Quality_num   Alcohol_Consumption_num      Stress_Level_cat_num \n                0.9209048                 0.9470903                 0.8875062 \n              BMI_cat_num        Heart_Rate_cat_num                BP_cat_num \n                0.9595019                 1.0595403                 1.0203396 \n       Family_History_num Cholesterol_Level_cat_num \n                0.9670273                 0.9295625 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check collinearity\ncheck_c <- check_collinearity(model_log_youth)\n\n# Print the collinearity check results\nprint(check_c)\n\n# Plot collinearity diagnostics\nplot(check_c)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint.default(model_log_youth)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                2.5 %      97.5 %\n(Intercept)               -2.27756591 -1.59920051\nGender_num                -0.12079445  0.16509808\nRegion_num                -0.20026248  0.10791582\nSmoking_History_num       -0.12126241  0.19054601\nDiabetes_History_num       0.06507627  0.40032007\nPhysical_Activity_num     -0.11071131  0.07362587\nDiet_Quality_num          -0.17862059  0.01382343\nAlcohol_Consumption_num   -0.13307122  0.02434948\nStress_Level_cat_num      -0.22586001 -0.01281956\nBMI_cat_num               -0.14936657  0.06668465\nHeart_Rate_cat_num        -0.08442686  0.20009715\nBP_cat_num                -0.04757126  0.08784222\nFamily_History_num        -0.19091804  0.12386083\nCholesterol_Level_cat_num -0.18395596  0.03787357\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\npredictions <- predict(model_log_youth, type = \"response\")\npredicted_classes <- ifelse(predictions > 0.5, 1, 0)\nconfusionMatrix(as.factor(predicted_classes), as.factor(HA_youth$Heart_Attack_Occurrence_num))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction    0    1\n         0 7932  834\n         1    0    0\n                                          \n               Accuracy : 0.9049          \n                 95% CI : (0.8985, 0.9109)\n    No Information Rate : 0.9049          \n    P-Value [Acc > NIR] : 0.5092          \n                                          \n                  Kappa : 0               \n                                          \n Mcnemar's Test P-Value : <2e-16          \n                                          \n            Sensitivity : 1.0000          \n            Specificity : 0.0000          \n         Pos Pred Value : 0.9049          \n         Neg Pred Value :    NaN          \n             Prevalence : 0.9049          \n         Detection Rate : 0.9049          \n   Detection Prevalence : 1.0000          \n      Balanced Accuracy : 0.5000          \n                                          \n       'Positive' Class : 0               \n                                          \n```\n\n\n:::\n:::\n\n\n\n### 5.2 Variables important\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract coefficients from the model\ncoef_data <- as.data.frame(coef(summary(model_log_youth)))\ncoef_data$Feature <- rownames(coef_data)\nrownames(coef_data) <- NULL\n\n# Plot the coefficients\nlibrary(ggplot2)\nggplot(coef_data, aes(x = reorder(Feature, Estimate), y = Estimate)) +\n  geom_bar(stat = \"identity\", fill = \"#FF1493\") +\n  coord_flip() +\n  labs(title = \"Feature Importance (Logistic Regression Coefficients)\",\n       x = \"Feature\",\n       y = \"Coefficient Estimate\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n\n::: Callout-note\nThe model results show that stress level and diabetes history are statically significant in leading to higher risk of heart attack in youth.\n\nBesides two two variables, it seems that Diet quality may also play a role in leading heart attack in Japanese youth, although the significant level at 0.1 which is more than the standard 0.05.\n:::\n\n#### 5.2.1 other codes in looking into model parameters (should not be include in the assignment counts) \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\npredictions <- predict(model_log_youth, type = \"response\")\npredicted_classes <- ifelse(predictions > 0.5, 1, 0)\nconfusionMatrix(as.factor(predicted_classes), as.factor(HA_youth$Heart_Attack_Occurrence_num))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction    0    1\n         0 7932  834\n         1    0    0\n                                          \n               Accuracy : 0.9049          \n                 95% CI : (0.8985, 0.9109)\n    No Information Rate : 0.9049          \n    P-Value [Acc > NIR] : 0.5092          \n                                          \n                  Kappa : 0               \n                                          \n Mcnemar's Test P-Value : <2e-16          \n                                          \n            Sensitivity : 1.0000          \n            Specificity : 0.0000          \n         Pos Pred Value : 0.9049          \n         Neg Pred Value :    NaN          \n             Prevalence : 0.9049          \n         Detection Rate : 0.9049          \n   Detection Prevalence : 1.0000          \n      Balanced Accuracy : 0.5000          \n                                          \n       'Positive' Class : 0               \n                                          \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\ntrain_indices <- sample(1:nrow(HA_youth), 0.7 * nrow(HA_youth))\ntrain_data <- HA_youth[train_indices, ]\ntest_data <- HA_youth[-train_indices, ]\n\n# Fit the model on the training data\nmodel_train <- glm(Heart_Attack_Occurrence_num ~ Gender_num + Region_num + Smoking_History_num + Diabetes_History_num + Physical_Activity_num + Diet_Quality_num + Alcohol_Consumption_num + Stress_Level_cat_num + BMI_cat_num + Heart_Rate_cat_num + BP_cat_num + Family_History_num + Cholesterol_Level_cat_num, family = binomial(), data = train_data)\n\n# Predict on the test data\ntest_predictions <- predict(model_train, newdata = test_data, type = \"response\")\ntest_predicted_classes <- ifelse(test_predictions > 0.5, 1, 0)\n\n# Evaluate the model on the test data\nconfusionMatrix(as.factor(test_predicted_classes), as.factor(test_data$Heart_Attack_Occurrence_num))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction    0    1\n         0 2373  257\n         1    0    0\n                                          \n               Accuracy : 0.9023          \n                 95% CI : (0.8903, 0.9134)\n    No Information Rate : 0.9023          \n    P-Value [Acc > NIR] : 0.5166          \n                                          \n                  Kappa : 0               \n                                          \n Mcnemar's Test P-Value : <2e-16          \n                                          \n            Sensitivity : 1.0000          \n            Specificity : 0.0000          \n         Pos Pred Value : 0.9023          \n         Neg Pred Value :    NaN          \n             Prevalence : 0.9023          \n         Detection Rate : 0.9023          \n   Detection Prevalence : 1.0000          \n      Balanced Accuracy : 0.5000          \n                                          \n       'Positive' Class : 0               \n                                          \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggcoefstats(model_log_youth, \n            output = \"plot\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(model_log_youth )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5516.885\n```\n\n\n:::\n:::\n\n\n\n## 6.0 Final charts and conclusion\n\n::: Call-note\nWith acknowledge of the how the variables related to the occurrence of heart attack, in this section, we will do up the charts to visually show the relationship between the variables and heart attack in youth.\n\nSince the earlier charts has already compared the main group of of interest youth with heart attack, with adults with heart attack and youth without heart attack. This section is dedicated to show visualise the relationship of the variables within the group\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP1 <-ggplot(data=HA_youth_yes, \n            aes(x= BMI, \n                y= Stress_Levels, \n                color=Diabetes_History)) +\n  geom_point(size=1) +\n  coord_cartesian(xlim=c(5,40),\n                  ylim=c(0,11))\n\nP2<- ggMarginal(P1, type = \"boxplot\",\n           groupColour = TRUE, \n           groupFill = TRUE)+ theme_minimal()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nP3 <-ggplot(data=HA_youth_yes,\n       aes(x = Diabetes_History , y = Stress_Levels, color = Diet_Quality )) +\n    geom_boxplot()+\n  facet_wrap(~ BMI_cat)+ theme_minimal()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nP4<-ggplot(HA_youth_yes, \n       aes(x = Diabetes_History, y = Stress_Levels)) +\n  stat_halfeye(adjust = 0.5,\n               justification = 0.1,\n               .width = 0,\n               point_colour = NA) +\n  stat_dots(side = \"left\", \n            justification = 1.1, \n            binwidth = .5,\n            dotsize = 0.05)\n  #coord_flip() +\n  theme_economist()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 39\n $ line                :List of 6\n  ..$ colour       : chr \"black\"\n  ..$ linewidth    : NULL\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ rect                :List of 5\n  ..$ fill         : Named chr NA\n  .. ..- attr(*, \"names\")= chr NA\n  ..$ colour       : logi NA\n  ..$ linewidth    : NULL\n  ..$ linetype     : num 1\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ text                :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : chr \"black\"\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title          :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.x        :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.title.y        :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text           :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x         :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 10points 0points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.x.top     :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : num 0\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 0points 10points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.text.y         :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : 'margin' num [1:4] 0points 10points 0points 0points\n  .. ..- attr(*, \"unit\")= int 8\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ axis.ticks          :List of 6\n  ..$ colour       : NULL\n  ..$ linewidth    : NULL\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ axis.ticks.y        : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ axis.ticks.length   : 'simpleUnit' num -5points\n  ..- attr(*, \"unit\")= int 8\n $ axis.line           :List of 6\n  ..$ colour       : NULL\n  ..$ linewidth    : 'rel' num 0.8\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ axis.line.y         : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ legend.background   :List of 5\n  ..$ fill         : NULL\n  ..$ colour       : NULL\n  ..$ linewidth    : NULL\n  ..$ linetype     : num 0\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ legend.spacing      : 'simpleUnit' num 15points\n  ..- attr(*, \"unit\")= int 8\n $ legend.key          :List of 5\n  ..$ fill         : NULL\n  ..$ colour       : NULL\n  ..$ linewidth    : NULL\n  ..$ linetype     : num 0\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ legend.key.size     : 'simpleUnit' num 1.2lines\n  ..- attr(*, \"unit\")= int 3\n $ legend.key.height   : NULL\n $ legend.key.width    : NULL\n $ legend.text         :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1.25\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.title        :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ legend.position     : chr \"top\"\n $ legend.direction    : NULL\n $ legend.justification: chr \"center\"\n $ panel.background    :List of 5\n  ..$ fill         : NULL\n  ..$ colour       : NULL\n  ..$ linewidth    : NULL\n  ..$ linetype     : num 0\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ panel.border        : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ panel.spacing       : 'simpleUnit' num 0.25lines\n  ..- attr(*, \"unit\")= int 3\n $ panel.grid.major    :List of 6\n  ..$ colour       : chr \"white\"\n  ..$ linewidth    : 'rel' num 1.75\n  ..$ linetype     : NULL\n  ..$ lineend      : NULL\n  ..$ arrow        : logi FALSE\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_line\" \"element\"\n $ panel.grid.minor    : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n $ plot.background     :List of 5\n  ..$ fill         : Named chr \"#d5e4eb\"\n  .. ..- attr(*, \"names\")= chr \"blue-gray\"\n  ..$ colour       : logi NA\n  ..$ linewidth    : NULL\n  ..$ linetype     : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ plot.title          :List of 11\n  ..$ family       : NULL\n  ..$ face         : chr \"bold\"\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1.5\n  ..$ hjust        : num 0\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ plot.margin         : 'simpleUnit' num [1:4] 12points 10points 12points 10points\n  ..- attr(*, \"unit\")= int 8\n $ strip.background    :List of 5\n  ..$ fill         : Named chr NA\n  .. ..- attr(*, \"names\")= chr NA\n  ..$ colour       : logi NA\n  ..$ linewidth    : NULL\n  ..$ linetype     : num 0\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_rect\" \"element\"\n $ strip.text          :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : 'rel' num 1.25\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ strip.text.x        :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : NULL\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ strip.text.y        :List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : num -90\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi TRUE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n $ panel.grid.major.x  : list()\n  ..- attr(*, \"class\")= chr [1:2] \"element_blank\" \"element\"\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi TRUE\n - attr(*, \"validate\")= logi TRUE\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#| fig-width: 24 #to widen the space\n#| fig-height: 24 #to lengthen the graph\n\nPatchwork <- P4 |P3\n\nPatchwork\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n\n::: Callout-note\nAfter establishing the following:\n\n-Stress Level and Diabetes History have statistically significant related to incidents of heart attack in youth using the logistic regression model. Although diet history may not have statistically significant, but is worthwhile to explore its relationship with other variables.\n\n-there is statistically significant differences in true group mean in stress level between youth whom had heart attack and without heart attack.\n\n-the various BMI categories seem to have statically significant associations in relation of heart attack, proven using chi square.\n\nThe 4 variables of the ***youth whom had heart attack*** plotted using the half eye chart, box plot across the BMI categories to further analyse the relationships among the mentioned variables.\n\n**Observation**\n\nAs mentioned in section 5, that the logistic regression, that the stress level is by Likert scale as the data is discrete instead of continuous as shown in the dot stats chart. Based on the chart, we can see the youth with higher stress level had diabetes before as compared to those who has not have diabetes before.\n\nThis trend could be further showed by the box plot on the right. The boxplot is facet across the various BMI categories.\n\nAt a quick glance, we could see obese youth whom had heart attack, has highest stress level. This particular group of youth also had the poor diet quality and diabetes before.\n\nIt was also noted there are overall higher stress level in overweight and obese youths as compared to those with normal BMI or underweight.\n\nAmong the youths, it was also noted. that two groups with the highest stress level are the obese and overweight youths with poor diet quality.\n\nFurther analysis could be carried out to further explore characteristic of Japanese Youth whom had heart attack. It is important to note that more information on the data set would be require before further conclusion could be drawn\n\n**Conclusion**\n\nLearning points from this take home exercise is that data visualising is not direct. It requires student or analyst to have a throughout understanding of the data set before the analyst could make use of the tools to present the data in a accurate and simplify manner which allow viewers to be able to see the trend of the data set.\n:::\n\n### 7.0 Other Charts and visualisation tools used.\n\nAs part of the learning journey, there are may other charts tried to visualise the data. However due to the assignment limit, they are not added to the main part of the assessment.\n\n##### Histogram to compare subjects with heart attack in youth and adults\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhistograms <- ggplot(contin_col_HA_Long_Yes, aes(x = Value, fill = Age_Grp )) + \n  geom_histogram(binwidth = 1, alpha = 0.8) + \n  theme_minimal() + \n  labs(title = \"Histograms of Continuous Fields\", y = \"Frequency\")+\n  facet_wrap(~ Field, scales = \"free\") \n\n# Print the histograms\nprint(histograms)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n\n##### visualizing using density plot to further understand stress level\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Adding density plot\nggplot(HA_youth, aes(x = Stress_Levels)) +\n  geom_histogram(aes(y = ..density..), binwidth = 1, fill = \"blue\", alpha = 0.5) +\n  geom_density(color = \"red\", size = 1) +\n  labs(title = \"Histogram and Density Plot of Stress Levels\", x = \"Stress Levels\", y = \"Density\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\n\n##### Correlation plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHA.cor <- cor(HA_youth_yes[, c(7, 11:15)], use = \"complete.obs\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(HA.cor)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(HA, aes(x = Stress_Levels, fill = Heart_Attack_Occurrence)) +  # Map fill to Heart_Attack_Occurrence\n  geom_histogram(aes(y = ..density..), binwidth = 1, alpha = 0.5, position = \"identity\") +  # Adjust position for overlap\n  geom_density(color = \"red\", size = 1, alpha = 0.3) +  # Density plot with transparency\n  labs(title = \"Histogram and Density Plot of Stress Levels\",\n       x = \"Stress Levels\",\n       y = \"Density\") +\n  theme_minimal(base_size = 14) +  # Improve overall theme and font size\n  scale_fill_brewer(palette = \"Set2\", name = \"Heart Attack Occurrence\") +  # Use a color palette for filling\n  theme(legend.position = \"top\")  # Position the legend at the top\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nscatter_plot <- ggplot(HA, aes(x = Stress_Levels, y = BMI, color = Heart_Attack_Occurrence)) +\n  geom_point(size = 1, alpha = 0.4) +  # Adjust point size and transparency\n  labs(title = \"Scatter Plot of Stress Levels vs. BMI\",\n       x = \"Stress Levels\",\n       y = \"BMI\",\n       color = \"Heart Attack Occurrence\") +  # Add title and labels\n  theme_minimal(base_size = 14) +  # Use a clean theme with larger base font size\n  scale_color_manual(values = c(\"blue\", \"red\"))  # Customize colors if needed\n\n# Print the scatter plot\nprint(scatter_plot)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-49-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(HA, aes(x = Smoking_History, fill = Heart_Attack_Occurrence)) +\n  geom_bar(position = \"fill\") +\n  labs(title = \"Smoking History vs Heart Attack Occurrence\", \n       y = \"Proportion\", \n       x = \"Smoking History\") +\n  scale_fill_manual(values = c(\"lightblue\", \"salmon\"), name = \"Heart Attack Occurrence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex_01_files/figure-html/unnamed-chunk-50-1.png){width=672}\n:::\n:::\n\n\n\n#### Disclaimer\n\nThis take home exercise was done with reference to methods in Prof Kam's e text book https://r4va.netlify.app/ , materials on R available online and the use of Microsoft co-pilot to troubleshoot syntax errors and streamline codes.\n",
    "supporting": [
      "Take-home_Ex_01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}