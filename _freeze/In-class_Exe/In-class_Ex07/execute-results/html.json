{
  "hash": "9c27303dbc8deaa2086fa7809e06bc4c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"In-Class Ex 07\"\nauthor: \"Dew Stella Chan\"\n\ndate: \"2025-03-01\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, tsibble, feasts, fable, seasonal)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_data <- read_csv(\n  \"data/visitor_arrivals_by_air.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_data$`Month-Year` <- dmy(\n  ts_data$`Month-Year`)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_dataa_ts <- ts(ts_data) #indicate as time series data frame, is not tsclassibble dataframe\nhead (ts_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 34\n  `Month-Year` `Republic of South Africa` Canada   USA Bangladesh Brunei China\n  <date>                            <dbl>  <dbl> <dbl>      <dbl>  <dbl> <dbl>\n1 2008-01-01                         3680   6972 31155       6786   3729 79599\n2 2008-02-01                         1662   6056 27738       6314   3070 82074\n3 2008-03-01                         3394   6220 31349       7502   4805 72546\n4 2008-04-01                         3337   4764 26376       7333   3096 76112\n5 2008-05-01                         2089   4460 26788       7988   3586 64808\n6 2008-06-01                         2515   3888 29725       8301   5284 55238\n# ℹ 27 more variables: `Hong Kong SAR (China)` <dbl>, India <dbl>,\n#   Indonesia <dbl>, Japan <dbl>, `South Korea` <dbl>, Kuwait <dbl>,\n#   Malaysia <dbl>, Myanmar <dbl>, Pakistan <dbl>, Philippines <dbl>,\n#   `Saudi Arabia` <dbl>, `Sri Lanka` <dbl>, Taiwan <dbl>, Thailand <dbl>,\n#   `United Arab Emirates` <dbl>, Vietnam <dbl>, `Belgium & Luxembourg` <dbl>,\n#   Finland <dbl>, France <dbl>, Germany <dbl>, Italy <dbl>, Netherlands <dbl>,\n#   Spain <dbl>, Switzerland <dbl>, `United Kingdom` <dbl>, Australia <dbl>, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_tsibble <- ts_data %>%\n  mutate(Month = yearmonth(`Month-Year`)) %>%\n  as_tsibble(index = `Month`)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_longer <- ts_data %>%\n  pivot_longer(cols = c(2:34),\n               names_to = \"Country\",\n               values_to = \"Arrivals\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nts_longer %>%\n  filter(Country == \"Vietnam\") %>% #this could be one of the parameters. \n  ggplot(aes(x = `Month-Year`, \n             y = Arrivals))+\n  geom_line(size = 0.5)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ts_longer, \n       aes(x = `Month-Year`, \n           y = Arrivals,\n           color = Country))+\n  geom_line(size = 0.5) +\n  theme(legend.position = \"bottom\", \n        legend.box.spacing = unit(0.5, \"cm\"))\n```\n\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer <- ts_tsibble %>%\n  pivot_longer(cols = c(2:34),\n               names_to = \"Country\",\n               values_to = \"Arrivals\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Italy\" |\n         Country == \"Vietnam\" |\n         Country == \"United Kingdom\" |\n         Country == \"Germany\") %>% \n  gg_season(Arrivals)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Vietnam\" |\n         Country == \"Italy\") %>% \n  autoplot(Arrivals) + \n  facet_grid(Country ~ ., scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Vietnam\" |\n         Country == \"Italy\") %>% \n  gg_subseries(Arrivals) #the subseries function is a cycle plot\n```\n\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\") %>%\n  ACF(Arrivals) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\" |\n         `Country` == \"Italy\" |\n         `Country` == \"United Kingdom\" |\n         `Country` == \"China\") %>%\n  PACF(Arrivals) %>%\n  autoplot()\n```\n\n::: {.cell-output-display}\n![](In-class_Ex07_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "In-class_Ex07_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}